<style>
    @import url('https://fonts.googleapis.com/css2?family=Open+Sans:wght@300;400;600;800&display=swap');
</style>
<style type="text/css">
    body, html {
        font-family: 'Open Sans', sans-serif;
        font-size: 15px;
        line-height: 1.57142857;
        color: #76838f;
    }
    table, tr, td{
        font-family: 'Open Sans', sans-serif;
    }
    .customers_equ{color:#424242; font-size:15px; width:100%; border:1px solid #bbb; border-radius:10px 10px 0 0;}
    .customers_equ td{border-bottom:1px solid #bbb;padding:10px; border-right:1px solid #bbb;}
    .customers_equ td:last-child{border-right:none}
    .customers_equ th{background-color:#f3b90f;color:#424242;font-size:16px;font-weight:600;height:45px;text-align:center}
    .row{margin-right:5px;margin-left:5px;}
    .pdf-logo{width:200px;height:60px;align-items:center}
    .pdf-logo img{width:200px}
    .pdf-downloadbtn{color:#202f7d;text-align:center;font-weight:800;font-size:25px;line-height:28px;margin:0}
    .pdf-date{text-align:right;font-size:14px;font-style:italic;font-weight:400;color:#fff;background-color:#1e2c76;padding:5px 30px;float:right;margin-top:5px;border-radius:20px 10px;position:relative;top:24px}
    .pie-title-center{margin:auto;position:relative;text-align:center}.pie-title-center p{display:block;position:absolute;height:40px;top:63%;left:0;right:0;margin-top:-20px;line-height:22px;font-size:18px;color:#333;font-weight:600}
    .pie-value-txt{display:block;position:absolute;font-size:16px;height:40px;top:46px;margin:0 auto;font-weight:600;color:#000;width:200px;text-align:center;padding:10px 0px}.rc_progress{overflow:visible;border-radius:10px;margin:0 auto 40px auto;max-width:900px}​​ .pie-value{font-size:40px;font-weight:800}.title_imporve{text-align:center;font-size:28px;padding:5px 0;font-weight:500;color:#000}.progress{border-radius:5px;overflow:inherit}.redpb{background-color:#ff6c6c!important;border-right:solid 2px #fff}
    .orangepb{background-color:#ffb36c!important;border-right:solid 2px #fff}.greenpb{background-color:#82e360!important;border-right:solid 2px #fff}.bluepb{background-color:#1483f2!important}.yellowpb{background-color:#f5d13d!important}
    .donutchart{width:200px;margin:0 auto;height:200px}.donutchart h3{font-size:18px;font-weight:600;padding:0 0 20px;color:#000}.progress-bar span{color:#262626;top:-25px;position:relative;z-index:4;font-weight:600;font-size:13px}.rc_progress .progress-bar-act{position:absolute!important;width:12px;height:50px;top:-18px;border-radius:0px;border:solid 1px #fff;z-index:99}​​​​​ .progress-meter{min-height:5px}.progress-meter>.meter{position:relative;float:left;min-height:5px}.progress-meter>.meter-left{border-left-width:2px}.progress-meter>.meter-right{float:right;border-right-width:2px}.progress-meter>.meter-right:last-child{border-left-width:2px}.progress-meter>.meter>.meter-text{position:absolute;display:inline-block;bottom:-5px;width:100%;font-weight:700;font-size:.85em;color:#000;text-align:right}.progress-meter>.meter.meter-right>.meter-text{text-align:right}.mt-mb{margin:25px auto}.customerdata{margin:45px auto}#customers{font-family: 'Open Sans', sans-serif; border-collapse:separate;color:#424242;font-size:15px;width:100%;border:1px solid #bbb;border-radius:10px 10px 0 0;overflow:hidden}#customers td{font-family: 'Open Sans', sans-serif; border-bottom:1px solid #bbb;padding:12px 10px;color:#000;font-weight:500;border-right:1px solid #bbb}#customers td:last-child{border-right:none}#customers th{background-color:#f3b90f;color:#424242;font-size:16px;font-weight:600;height:45px;text-align:center}.reportdata{margin:45px auto}#reportdata{border-collapse:collapse;color:#222;font-size:15px;width:100%}#reportdata td{padding:10px 50px;background-color:#e8e8e8;font-weight:600}#reportdata th{ background-color:#273581;color:#fff;font-size:16px;font-weight:600;height:45px;text-align:center}.non-headtxt{position:relative;margin:25px auto;text-align:center;display:block}.non-headtxt h2{font-size:18px;font-weight:600;background-color:#f3b90f;width:200px;padding:10px 30px;border-radius:20px;color:#000;text-align:center;z-index:99;position:relative;text-align:center;margin:0 auto}.non-headtxt span{border-bottom:solid 1px #424242;display:block;top:-19px;position:relative;z-index:1}.statistics_item{background-color:#273581;text-align:center;padding:15px;border-bottom:solid 4px #0b1130;border-radius:20px;box-shadow:3px 3px 15px #d3d3d3;-moz-box-shadow:3px 3px 15px #d3d3d3;-webkit-box-shadow:3px 3px 15px #d3d3d3;-o-box-shadow:3px 3px 15px #d3d3d3;width:90%;height:130px;margin:15px auto}.statistics_item .counter{font-size:35px;font-weight:700;margin-top:10px;height:50px;color:#fff}.statistics_item p{color:#d1d1d1; padding-top:20px;}.statistics_item .counter span{font-size:25px;font-weight:700}.pb-hr{border-bottom:solid 1px #424242;display:block;position:relative;margin:25px auto}.publicdeeds{margin:45px auto}.donutchart1{width:150px;margin:0 auto}.donutchart1 h3{font-size:18px;font-weight:600;padding:0 0 20px;color:#000}.pie-value-txt1{display:block;position:absolute;height:40px;top:56%;left:0;right:0;line-height:20px;font-weight:600;color:#000;text-align:center;width:150px;margin:0 auto}.pie-value1{font-size:18px;font-weight:700}#publicdeeds{border-collapse:collapse;color:#222;font-size:15px;width:100%}#publicdeeds td{padding:10px 5px;border:1px solid #bbb;font-weight:600;text-align:center;border-radius:15px 15px 0 0}#publicdeeds th{background-color:#273581;color:#fff;font-size:16px;font-weight:600;height:45px;text-align:center;border-radius:15px 15px 0 0}.publicdeeds2{margin:25px auto}#publicdeeds2{border-collapse:collapse;color:#222;font-size:15px;width:100%}#publicdeeds2 td{padding:10px 25px;font-weight:600}#publicdeeds2 th{background-color:#273581;color:#fff;font-size:16px;font-weight:600;height:45px;padding:10px 25px;border-radius:15px 15px 0 0;text-align:center}.creditage{margin:45px auto}#creditage{border-collapse:collapse;color:#222;font-size:15px;width:100%}#creditage td{padding:10px 25px;font-weight:600;text-align:center}#creditage th{background-color:#273581;color:#fff;font-size:16px;font-weight:600;height:45px;padding:10px 25px;border-radius:15px 15px 0 0;text-align:center}.totalaccount{margin:45px auto}#totalaccount{border-collapse:collapse;color:#222;font-size:15px;width:100%}#totalaccount td{padding:10px 5px;border:1px solid #bbb;font-weight:600;text-align:center}#totalaccount th{background-color:#273581;color:#fff;font-size:16px;font-weight:600;height:45px;padding:10px 25px;border-radius:15px 15px 0 0;text-align:center}.openacdetails{margin:45px auto}#openacdetails{border-collapse:collapse;color:#222;font-size:15px;width:100%}#openacdetails td{padding:10px 25px;font-weight:600;text-align:left}#openacdetails th{background-color:#273581;color:#fff;font-size:16px;font-weight:600;height:45px;padding:10px 25px;border-radius:15px 15px 0 0;text-align:center}.paymenthistory{margin:45px auto}#paymenthistory{border-collapse:collapse;color:#222;font-size:15px;width:100%;table-layout:fixed}#paymenthistory td{overflow:hidden; padding:5px 5px;border:1px solid #bbb;font-weight:600;text-align:center;width:calc(100%/13); height:50px;}#paymenthistory th{background-color:#273581;color:#fff;font-size:16px;font-weight:600;height:45px;text-align:center;border-radius:15px 15px 0 0}
    .red-roundbg{width:34px;height:34px;position:relative;background-color:#f22a2a;border-radius:17px;line-height:17px;margin:4px auto;color:#fff;font-size:12px;font-weight:600; border: 1px solid #f22a2a;}
    .pur-roundbg{width:34px;height:34px;position:relative;background-color:#db22cd;border-radius:17px;line-height:17px;margin:4px auto;color:#fff;font-size:12px;font-weight:600}
    .lblue-roundbg{width:34px;height:34px;position:relative;background-color:#79d2de;border-radius:17px;line-height:17px;margin:4px auto;color:#fff;font-size:12px;font-weight:600}
    .green-roundbg{width:34px;height:34px;position:relative;background-color:#1da727;border-radius:17px;line-height:17px;margin:4px auto;color:#fff;font-size:12px;font-weight:600}
    .blue-roundbg{width:34px;height:34px;position:relative;background-color:#147ad6;border-radius:17px;line-height:17px;margin:4px auto;color:#fff;font-size:12px;font-weight:600}
    .bri-roundbg{width:34px;height:34px;position:relative;background-color:#7849c4;border-radius:17px;line-height:17px;margin:4px auto;color:#fff;font-size:12px;font-weight:600}
    .black-roundbg{width:34px;height:34px;position:relative;background-color:#000;border-radius:17px;line-height:17px;margin:4px auto;color:#fff;font-size:12px;font-weight:600}
    .orange-roundbg{width:34px;height:34px;position:relative;background-color:#ff9d00;border-radius:17px;line-height:17px;margin:4px auto;color:#fff;font-size:12px;font-weight:600;}
    .tab-legends{display:flex;position:relative;flex-direction:row;margin:10px auto;flex-wrap:wrap;justify-content:space-between; width:100%;}.tab-legends li{list-style:none;margin-right:10px;font-size:13px;color:#000;font-weight:300;line-height:15px}.tab-legends li>div{display:inline-flex;margin-right:5px;top:3px;position:relative}.tab-blue{width:15px;height:15px;box-sizing:border-box;border-radius:3px;background-color:#147ad6}.tab-lblue{width:15px;height:15px;box-sizing:border-box;border-radius:3px;background-color:#79d2de}.tab-green{width:15px;height:15px;box-sizing:border-box;border-radius:3px;background-color:#1da727}.tab-red{width:15px;height:15px;box-sizing:border-box;border-radius:3px;background-color:#f22a2a}.tab-orange{width:15px;height:15px;box-sizing:border-box;border-radius:3px;background-color:#ff9d00}.tab-bri{width:15px;height:15px;box-sizing:border-box;border-radius:3px;background-color:#7849c4}.tab-pur{width:15px;height:15px;box-sizing:border-box;border-radius:3px;background-color:#db22cd}.tab-black{width:15px;height:15px;box-sizing:border-box;border-radius:3px;background-color:#000}#averagedaystb{border-collapse:collapse;color:#222;font-size:15px;width:100%;table-layout:fixed;margin:0 -15px}#averagedaystb td{padding:10px 5px;border:1px solid #bbb;font-weight:600;text-align:center}#averagedaystb th{color:#000;font-size:16px;font-weight:800;height:45px;text-align:center;border:1px solid #bbb}
    .wapper{width: 100%; overflow: scroll; position:absolute; display:inline-block; margin-bottom:20px; top:50px}
    header {
        position: fixed;
        top:-30px;
        color: #273581;
        text-align: center;
        display:block !important;
        height:60px;

    }

    .title_imporve.progress_bar_green{color:#82e360!important; background: none !important;}
    .title_imporve.progress_bar_yellow{color:#f5d13d!important;  background: none !important;}
    .title_imporve.progress_bar_orange{color:#ffb36c!important;  background: none !important;}
    .title_imporve.progress_bar_red{color:#ff6c6c!important;  background: none !important;}
    .progress_bar_green{background:#82e360!important}
    .progress_bar_yellow{background:#f5d13d!important}
    .progress_bar_orange{background:#ffb36c!important}
    .progress_bar_red{background:#ff6c6c!important}
    .right-block{float:right}
    .pdf_screens{width:1260px;margin:0 auto 0 auto}
    .pdf_block{border:solid 1px #e9e9e9;padding:15px 20px;background:#fff;box-shadow:3px 3px 15px #eee;-moz-box-shadow:3px 3px 15px #eee;-webkit-box-shadow:3px 3px 15px #eee;-o-box-shadow:3px 3px 15px #eee;margin-bottom:30px}
    .item{border:solid 1px #e9e9e9;padding:15px 15px;background:#fff;box-shadow:3px 3px 15px #eee;-moz-box-shadow:3px 3px 15px #eee;-webkit-box-shadow:3px 3px 15px #eee;-o-box-shadow:3px 3px 15px #eee;margin-bottom:30px;}
    .item p,.item span{font-size:14px;line-height:22px}
    .pdf_progress{height:350px;text-align:center}
    .left_top{float:left;width:50%;text-align:left}
    .right_top{float:right;text-align:right;width:50%}
    .clear{clear:both;width:100%;height:1px;display:block}h1,h2,h3,h4,h5,h6,li,p{padding:0;margin:0}
    .rc_mid{padding:10px 0}
    .rc_mid h2{font-weight:700!important;text-align:center;font-size:100px;line-height:102px;color:#0d1332}
    .last-update,.rc_age .rc_block p.last-update{font-size:16px;color:#000;font-weight:600;text-align:left}
    .right_top h5{font-size:28px;line-height:30px;font-weight:400!important;color:#202f7d}
    .pdf_progress .right_top{text-align:right}
    .right_top p{color:#000;font-size:16px;line-height:20px}
    .rc_progress{width:900px;position:relative;margin:10px auto 70px auto;height:15px;border-radius:10px;background:#eee}
    .right_top h5{font-size:28px;line-height:30px;font-weight:400!important;color:#202f7d}
    .pdf_progress .right_top{text-align:right}
    .right_top p{color:#000;font-size:16px;line-height:20px}
    .rc_progress{width:900px;position:relative;margin:40px auto 90px auto;height:15px;background:#eee}
    .rc_progress .progress-bar-danger{background:#ff6c6c!important;height:15px}
    .rc_progress .progress-bar span.lp,.rc_progress .progress-bar span.rp{font-size:16px;color:#000;font-weight:400;height:15px;width:30px;float:left;margin-top:40px}
    .rc_progress .progress-bar span.rp{float:right}
    .rc_progress .progress-bar-warning{background:#ffb36c!important}
    .rc_progress .progress-bar{position:relative;height:15px;float:left}
    .rc_progress .progress-bar-info{background:#f5d13d!important}
    .rc_progress .progress-bar-success{background:#82e360!important}
    .rc_progress .progress-bar-active{position:absolute!important;background:#82e360;width:12px;height:50px;top:-18px;border:solid 1px #fff;z-index:99}
    .rc_progress .progress-bar-danger::before,.rc_progress .progress-bar-info::before,.rc_progress .progress-bar-warning::before{content:"";width:5px;height:100%;position:absolute;right:0;top:0;background:#fff}
    .rc-pdf-block{width:358px;float:left;height:150px}
    .marginl{margin-left:30px}
    .sub{font-size:20px;line-height:24px;color:#0d1332;font-weight:400;padding:0 0 10px 0;margin:0}
    .rc_bottom .left_bottom p{font-size:18px;line-height:24px;color:#575c71;font-weight:600!important;margin-bottom:0}
    .rc_bottom .left_bottom p{font-size:16px}
    .rc_bottom i{display:inline-block;font-style:normal;width:80px;font-weight:400!important}
    .rc_bottom .left_bottom p span{color:#202f7d}
    .pdf-title{font-size:50px;line-height:56px;padding:0;font-weight:700;margin:0 0 30px 0;color:#202f7d}
    .sub-title{color:#000;font-size:26px;line-height:28px;font-weight:600;padding-bottom:20px;margin:0}

    .left-block{float:left}
    .grid_table{display:block;text-align:center; }
    .payment_history .item h4{float:left;text-align:left;line-height:40px}
    .payment_history .item h4 span{display:block;font-size:20px;font-weight:400;color:#000}
    .payment_history .item p{float:right;font-size:22px;line-height:24px;color:#000;font-weight:600;text-align:right;line-height:40px}
    .payment_history .item p span{color:#4cb826}
    .payment_history .item p em{font-style:normal;display:block;font-weight:400}
    .grid_table .grid-block{margin-top:15px;}
    .red-icon{width:15px;height:15px;background:#2dac00;border-radius:7px}
    .green-icon{width:15px;height:15px;background:#f5821f;border-radius:7px}
    .orange-icon{width:15px;height:15px;background:#ef4023;border-radius:7px}
    .anc_active{width:15px;height:15px;border-radius:7px}
    .oneitme{background:#2dac00; width:15px;height:15px;border-radius:7px}
    .miditme{background:#f5821f; width:15px;height:15px;border-radius:7px}
    .latetime{background:#ef4023; width:15px;height:15px;border-radius:7px}
    .grid_table table td,.grid_table table th{text-align:center;padding:1px 3px;font-weight:400!important;position:relative;color:#000!important;font-size:15px;line-height:18px;background:#fff!important}
    .anc_active{display:inline-block;position:relative;left:15px;top:3px;line-height:30px; margin: 3px 0 0 29px;}
    table{border-collapse:collapse;  }
    .enquires_section{page-break-inside: avoid;}


    .height_block{height:500px; overflow: hidden; }
    .sub_mainBlock.recordent_sub_mainBlock .block ul li{font-size:18px;line-height:26px;}
    .col-md-1 {
        width:8.33333333%
    }
    .col-md-2 {
        width:16.66666667%
    }
    .col-md-3 {
        width:25%
    }
    .col-md-4 {
        width:33.33333333%
    }
    .col-md-5 {
        width:41.66666667%
    }
    .col-md-6 {
        width:50%
    }
    .col-md-7 {
        width:58.33333333%
    }
    .col-md-8 {
        width:66.66666667%
    }
    .col-md-9 {
        width:75%
    }
    .col-md-10 {
        width:83.33333333%
    }
    .col-md-11 {
        width:91.66666667%
    }
    .col-md-12 {
        width:100%
    }
    .col-lg-1, .col-lg-2, .col-lg-3, .col-lg-4, .col-lg-5, .col-lg-6, .col-lg-7, .col-lg-8, .col-lg-9, .col-lg-10, .col-lg-11, .col-lg-12, .col-md-1, .col-md-2, .col-md-3, .col-md-4, .col-md-5, .col-md-6, .col-md-7, .col-md-8, .col-md-9, .col-md-10, .col-md-11, .col-md-12, .col-sm-1, .col-sm-2, .col-sm-3, .col-sm-4, .col-sm-5, .col-sm-6, .col-sm-7, .col-sm-8, .col-sm-9, .col-sm-10, .col-sm-11, .col-sm-12, .col-xs-1, .col-xs-2, .col-xs-3, .col-xs-4, .col-xs-5, .col-xs-6, .col-xs-7, .col-xs-8, .col-xs-9, .col-xs-10, .col-xs-11, .col-xs-12 {
        position: relative;
        min-height: 1px;
        padding-right: 15px;
        padding-left: 15px;
    }
    .col-md-1, .col-md-2, .col-md-3, .col-md-4, .col-md-5, .col-md-6, .col-md-7, .col-md-8, .col-md-9, .col-md-10, .col-md-11, .col-md-12 {
        float: left;
    }
    .row > [class*="col-"] {
        margin-bottom: 25px;
    }
    *, ::after, ::before {
        box-sizing: border-box;
    }* {
         outline: none;
     }.row::after {
          clear: both;
      }.row::after, .row::before {
           display: table;
           content: " ";
       }.row {
            margin-right: 5px;
            margin-left: 5px;
        }.justify-content-center {
             -ms-flex-pack: center !important;
             justify-content: center !important;
         }
    .donutcolor{
        width:200px;
        height:200px;
        border-radius:100px;
        background-color:#147ad6;
        font-size:16px;

    }
    .pie-value-txt{
        width: 170px;
        height: 170px;
        background-color: white;
        border-radius: 85px;
        margin: -30px 15px;
        padding:0px !important;
    }
    .noscore{
        line-height:70px;
    }
</style>

<?php

//dd($response);
$request_folder = array();
if(!empty($response['EfxTransmit']['StandardRequest'][0]['Folder'])){
    $request_folder = $response['EfxTransmit']['StandardRequest'][0]['Folder'];
}

if(empty($response['EfxTransmit'])){
    $response_folder = array();
}
else if(empty($response['EfxTransmit']['CommercialCreditReport'][0]['Folder'])){
    $response_folder = array();
}else{
    $response_folder = $response['EfxTransmit']['CommercialCreditReport'][0]['Folder'];
}
?>

<body>
<header>
    <table width="100%" allign="center">
        <tr>
            <td valign="top" style="width: 25%" class="pdf-logo"><img src="https://www.stage.recordent.com/main_logo.jpg" alt="Logo" data-default="placeholder" data-max-width="300" data-max-height="100"></td>
            <td valign="top" style="width: 50%;" class="pdf-downloadbtn">
                <?php
                echo $response['EfxTransmit']['StandardRequest'][0]['Folder']['IdTrait'][0]['CompanyNameTrait'][0]['BusinessName'];
                ?><br/>
                <span style="color: #000000; text-align:center !important;font-weight: 400; font-size: 18px;line-height: 28px;margin: 0px; padding-top:50px !important;">
		<?php
                    echo !empty($response_folder['ReportAttributes']['NonFinancialSummary']['SummaryAttributes']['CreditActiveSince']) ? "Credit Active Since - " . General::getFormatedDate($response_folder['ReportAttributes']['NonFinancialSummary']['SummaryAttributes']['CreditActiveSince']) : '-';
                    ?>
		</span>
            </td>
            <td valign="top" style="width: 25%;"><p class="pdf-date"><?php echo "Report Date: ".date('j F, Y',strtotime($response['EfxTransmit']['CommercialCreditReport'][0]['Header']['DateOfRequest']));?></p></td>
        </tr>
    </table>
</header>
<?php
//dd($response);
$request_folder = array();
if(!empty($response['EfxTransmit']['StandardRequest'][0]['Folder'])){
    $request_folder = $response['EfxTransmit']['StandardRequest'][0]['Folder'];
}

if(empty($response['EfxTransmit'])){
    $response_folder = array();
}
else if(empty($response['EfxTransmit']['CommercialCreditReport'][0]['Folder'])){
    $response_folder = array();
}else{
    $response_folder = $response['EfxTransmit']['CommercialCreditReport'][0]['Folder'];
}
$score ="";
$score = !empty($response_folder['DecisionTools']['ScoreData'][0]['score']) ? $response_folder['DecisionTools']['ScoreData'][0]['score'] : '' ;
// $score =650;
if(!empty($score)){
	$scoreText = 'Needs improvement';
	$needle_color = '#ff6c6c';
	  if($score > 400){
		$scoreText = 'Excellent';
		$needle_color = '#82e360';
	  }else if($score >= 301 && $score <= 400){
		  $scoreText='Good' ;
		  $needle_color = '#f5d13d';
	 }else if($score>= 201 && $score < 300){
		 $scoreText='Fair' ;
		 $needle_color = '#ffb36c';
	 }
}else{
	$scoreText = 'Not Available';
	$score     = "";
	$needle_color = '#147ad6';
}
?>

<div class="wapper" >
    <table width="100%" allign="center">
        <tr>
            <td colspan="3" style="height:50px;"></td>
        </tr>
        <tr>
            <td colspan="3" allign="center">
                <!--<div class="donutchart donutcolor">-->
				<div class="donutchart donutcolor" style="background-color:<?php echo $needle_color;?>;">
                    <div class="pie-value-txt <?php echo empty($score) ? ' noscore ' : '';  ?>"  valign="center">
                        <span style="margin-top:30px; font-size:20px; display:block;"><?php echo $score;?></span>
                        {{$scoreText}}
                    </div>
                </div>
            </td>
        </tr>
        </tr>
        <tr>
            <td colspan="3" allign="center">
                <div class="inner">
                    <div class="rc_mid">
                        <h2 style="font-size:20px; line-height:20px;">Score</h2>
                    </div>
                    <div class="profress-scroll">
						<div class="progress rc_progress">
							<?php
								if(!empty($score)){
									if ($score <= 200) {
										$score_indicator_pos = ($score/200)*17;
									} else if ($score > 200 && $score <= 300) {
										$score_indicator_pos = ($score/300)*34;
									} else if ($score > 300 && $score <= 400) {
										$score_indicator_pos = ($score/400)*51;
									} else {
										$score_width_diff = 687 - $score;
										$score_indicator_pos = 100 - ($score_width_diff/287)*49;
									}
								}
							?>
							<?php if(!empty($score)){ ?>
								<div id="progress-bar-active-score" class="progress-bar-act" role="progressbar" style="left:{{ number_format($score_indicator_pos, 2) }}%; background-color:{{$needle_color}}"></div>
							<?php } ?>
							<div class="progress-bar progress-bar-danger" role="progressbar" style="width:18%">
								<span class="lp">101</span><span class="rp">200</span></div>
							<div class="progress-bar progress-bar-warning" role="progressbar" style="width:18%">
								<span class="rp">300</span></div>
							<div class="progress-bar progress-bar-info" role="progressbar" style="width:18%">
								<span class="rp">400</span></div>
							<div class="progress-bar progress-bar-success" role="progressbar" style="width:46%">
								<span class="rp">687</span></div>
						</div>

                </div>
            </td>
        </tr>
        <tr>
            <td colspan="3">
                <table width="100%">
                    <tr>
                        <td style="text-align:center; margin:15px auto;">
                            <h2 class="page-title2">
                                <img src="https://www.test.recordent.com/front_new/images/team/equifaxlogo.svg"  height="30px" width="220px"></h2>
                        </td>
                    </tr>
                </table>
            </td>
        </tr>
        <tr><td colspan="3" style="height:50px;">&nbsp;</td></tr>
        <tr>
	   <td colspan="3" valign="top" class="customerdata">
		<table width="100%">
		    <tr>
			<td width="49%" valign="top">
				<table class="customers_equ">
                                            <tr>
                                            <th colspan="2"><strong>Enquiry Match</strong></th>
                                            </tr>
                                            <tr>
                                            <td style="width: 35%;"><b>Customer Ref</b></td>
                                            <td style="width: 65%;"><?php echo !empty($response['EfxTransmit']['customerReference']) ? $response['EfxTransmit']['customerReference'] : ' - ';
												?></td>
                                            </tr>
                                            <tr>
                                            <td><b>EFX ID</b></td>
                                            <td><?php  echo !empty($response_folder['EfxId']) ? $response_folder['EfxId'] : '-';?></td>
                                            </tr>
                                            <tr>
                                            <td><b>Company Profile</b></td>
                                            <td><?php
												echo $request_folder['IdTrait'][0]['AddressTrait'][0]['AddressLine1'].'<br>';
												echo !empty($request_folder['IdTrait'][0]['AddressTrait'][0]['City']['value']) ?
												$request_folder['IdTrait'][0]['AddressTrait'][0]['City']['value']. ", " : '' ;
												echo !empty($request_folder['IdTrait'][0]['AddressTrait'][0]['State']) ? $request_folder['IdTrait'][0]['AddressTrait'][0]['State'].', ' : '';
												echo !empty($request_folder['IdTrait'][0]['AddressTrait'][0]['PostalCode']) ? $request_folder['IdTrait'][0]['AddressTrait'][0]['PostalCode'] : '' ;

												?></td>
                                            </tr>
                                            <tr>
                                            <td><b>Telephone</b></td>
                                            <td><?php
													echo !empty($response_folder['Site'][0]['IdTrait']['AddressTrait'][0]['TelephoneTrait'][0]['TelephoneNumber']) ? $response_folder['Site'][0]['IdTrait']['AddressTrait'][0]['TelephoneTrait'][0]['TelephoneNumber'] : '-';
												?></td>
                                            </tr>
											<?php
												$taxId = "";
												$ssnId = "";
												if(!empty($response_folder['IdTrait'][0]['IdNumberTrait'])){
													foreach($response_folder['IdTrait'][0]['IdNumberTrait'] as $key => $value){

														if(!empty($value['IdNumberIndicator']) && $value['IdNumberIndicator']=="Tax ID"){

															$taxId = $value['IdNumber'];
														}
														if(!empty($value['IdNumberIndicator']) && $value['IdNumberIndicator']=="SSN"){

															$ssnId = $value['IdNumber'];
														}
													}
												} ?>
                                            <tr>
                                            <td><b>TAX-ID</b></td>
                                            <td><?php echo !empty($taxId) ? $taxId : ' - ';?></td>
                                            </tr>
                                            <tr>
                                            <td><b>SSN</b></td>
                                            <td><?php echo !empty($ssnId) ? $ssnId : ' - ';?></td>
                                            </tr>
                                            <tr>
                                            <td><b>Established</b></td>
                                            <td><?php
											if(!empty($response_folder['SOSTrait'][0]['CurrentSOSDataTrait']['IncorporationDate'])){
														echo !empty($response_folder['FirmographicsTrait'][0]['CurrentFirm']['YearStarted']) ? $response_folder['FirmographicsTrait'][0]['CurrentFirm']['YearStarted'] : '-';
													}else{
														echo '-';
													}?> </td>
                                            </tr>
                                            <tr>
                                            <td><b>Liability Type</b></td>
                                            <td><?php
														echo !empty($response_folder['FirmographicsTrait'][0]['CurrentFirm']['LiabilityIndicator']['value']) ? $response_folder['FirmographicsTrait'][0]['CurrentFirm']['LiabilityIndicator']['value'] : ' - ';
													?></td>
                                            </tr>
                                            <tr>
                                            <td><b>Ownership</b></td>
                                            <td><?php
													if(!empty($response_folder['FirmographicsTrait'][0]['CurrentFirm']['CompanyOwnership']['value'])){
														echo $response_folder['FirmographicsTrait'][0]['CurrentFirm']['CompanyOwnership']['value'];
													}else{
														echo '-';
													}
													 ?> </td>
                                            </tr>
                                            <tr>
                                            <td><b>Employees</b></td>
                                            <td><?php
													echo  !empty($response_folder['FirmographicsTrait'][0]['CurrentFirm']['NumberOfEmployees']['value']) ? $response_folder['FirmographicsTrait'][0]['CurrentFirm']['NumberOfEmployees']['value'] : '';
												?></td>
                                            </tr>
                                            <tr>
                                                <td><b>Location Type</b></td>
                                                <td><?php
													if(!empty($response_folder['Site'])) {

														foreach($response_folder['Site'] as $key => $BrValue){
															if($BrValue['EfxId']==$response_folder['EfxId'] && !empty($BrValue['HierarchyProperties'])){
																echo "Branch";
																//echo $BrValue['HierarchyProperties']['BusinessLevel'];
															}
														}
													}else{
														echo " - ";
													}
												?></td>
                                            </tr>
                                            <tr>
                                                <td><b>Annual Sales</b></td>
                                                <td><?php echo !empty($response_folder['FirmographicsTrait'][0]['CurrentFirm']['AnnualSalesRange']['value']) ? $response_folder['FirmographicsTrait'][0]['CurrentFirm']['AnnualSalesRange']['value'] : '-'; ?></td>
                                            </tr>
											<tr>
                                                <td><b>SIC</b></td>
                                                <td><?php echo !empty($response_folder['FirmographicsTrait'][0]['CurrentFirm']['SICCode']) ? $response_folder['FirmographicsTrait'][0]['CurrentFirm']['SICCode'].", " : '-';
												if(!empty($response_folder['FirmographicsTrait'][0]['CurrentFirm']['SICDescription'])){
													echo $response_folder['FirmographicsTrait'][0]['CurrentFirm']['SICDescription'];
												}
												?></td>
                                            </tr>
											<tr>
                                                <td><b>NAICS</b></td>
                                                <td><?php
												echo !empty($response_folder['FirmographicsTrait'][0]['CurrentFirm']['NAICSCode']) ? $response_folder['FirmographicsTrait'][0]['CurrentFirm']['NAICSCode'].", " : '-';

												if(!empty($response_folder['FirmographicsTrait'][0]['CurrentFirm']['NAICSDescription'])){
													echo $response_folder['FirmographicsTrait'][0]['CurrentFirm']['NAICSDescription'];
												}
												?>
												</td></tr>
											</table>
										</td>
										<?php
									/*bind data for HeadQuarter (Site[n]->HierarchyProperties->BusinessLevel == 'Headquarters'.)*/
									$isHeadquarters =  true;
									$HQEfxId 		=  "";
									$HQEfxIdMain	=  "";
									$HQCurrentFirmKey  = "";
									$HQTelephone 	   = "";
									$LegalBusinessName = "";
									$BusinessName 		= "";
									$HqCompanyAddress     = "";
									$HqCompCity			  = "";
									$HqCompState		  = "";
									$HqCompZip   		  = "";
									$LiabilityIndicator = "";
									$CompanyOwnership   = "";
									$NumberOfEmployees  = "";
									$StartedYear  		= "";
									$BusinessName = "";
									$SICCode = "";
									$SICDesc = "";
									$NAICSCode = "";
									$NAICSDescription = "";
									$AnnualSalesRange = "";

									if(!empty($response_folder['Site'])) {
										foreach($response_folder['Site'] as $key => $HQValue){

											$HQEfxId= $HQValue['EfxId'];
											if(!empty($HQValue['HierarchyProperties']) && $HQValue['HierarchyProperties']['BusinessLevel']=="Headquarters"){

												$HQEfxIdMain= $HQValue['EfxId'];
												$HqCompanyAddress = !empty($HQValue['IdTrait']['AddressTrait'][0]['AddressLine1']) ? $HQValue['IdTrait']['AddressTrait'][0]['AddressLine1'] : '';
												$HqCompCity = !empty($HQValue['IdTrait']['AddressTrait'][0]['City']['value']) ? ', '.$HQValue['IdTrait']['AddressTrait'][0]['City']['value'] : '';
												$HqCompState = !empty($HQValue['IdTrait']['AddressTrait'][0]['State']) ? ', '.$HQValue['IdTrait']['AddressTrait'][0]['State'] : '';
												$HqCompZip = !empty($request_folder['IdTrait']['AddressTrait'][0]['PostalCode']) ? $request_folder['IdTrait']['AddressTrait'][0]['PostalCode'] : '' ;
											}
										}

										//get key value on the basis of Headquarters ID.
										if(!empty($HQEfxIdMain)){

												foreach($response_folder['Site'] as $key => $HQValue){
												if(!empty($HQValue['FirmographicsTrait']['CurrentFirm']['NumberOfEmployees']) && $HQValue['EfxId']==$HQEfxIdMain){


													$HQCurrentFirmKey = $HQValue['FirmographicsTrait']['CurrentFirm'];
													$LiabilityIndicator = isset($HQCurrentFirmKey['LiabilityIndicator']['value'])?$HQCurrentFirmKey['LiabilityIndicator']['value']:'';
													$CompanyOwnership   = !empty($HQCurrentFirmKey['CompanyOwnership']['value']) ? $HQCurrentFirmKey['CompanyOwnership']['value'] : '';
													$NumberOfEmployees  = $HQCurrentFirmKey['NumberOfEmployees']['value'];
													$StartedYear  		= $HQCurrentFirmKey['YearStarted'];
													$AnnualSalesRange   = !empty($HQCurrentFirmKey['AnnualSalesRange']['value']) ? $HQCurrentFirmKey['AnnualSalesRange']['value'] : '';
												}
												if(!empty($HQValue['IdTrait']['CompanyNameTrait'][0]['BusinessName']) &&  !empty($HQValue['IdTrait']['CompanyNameTrait'][0]['LegalBusinessName']) && $HQValue['EfxId']==$HQEfxIdMain){

													$BusinessName = $HQValue['IdTrait']['CompanyNameTrait'][0]['BusinessName'];

													$LegalBusinessName = $HQValue['IdTrait']['CompanyNameTrait'][0]['LegalBusinessName'];

													$SICCode = !empty($HQValue['IdTrait']['CompanyNameTrait'][0]['SICCode'][0]) ? $HQValue['IdTrait']['CompanyNameTrait'][0]['SICCode'][0] : '';

													$SICDesc = !empty($HQValue['IdTrait']['CompanyNameTrait'][0]['SICDescription']) ? $HQValue['IdTrait']['CompanyNameTrait'][0]['SICDescription'] : '';

													$NAICSCode = !empty($HQValue['IdTrait']['CompanyNameTrait'][0]['NAICSCode'][0]) ? $HQValue['IdTrait']['CompanyNameTrait'][0]['NAICSCode'][0] : '';

													$NAICSDescription = !empty($HQValue['IdTrait']['CompanyNameTrait'][0]['NAICSDescription']) ? $HQValue['IdTrait']['CompanyNameTrait'][0]['NAICSDescription'] : '';
												}

												if(!empty($HQValue['IdTrait']['AddressTrait'][0]['TelephoneTrait']) && $HQValue['EfxId']==$HQEfxIdMain){

													$HQTelephone = $HQValue['IdTrait']['AddressTrait'][0]['TelephoneTrait'][0]['TelephoneNumber'];
												}
											}
										}
									}

								?>
				<td width="2%"></td>
				<td width="49%" valign="top">
			        <table class="customers_equ">
                                            <tr>
                                            <th colspan="2"><strong>Headquarters Site</strong></th>
                                            </tr>
                                            <tr>
                                            <td style="width: 35%;"><b>EFX ID</b></td>
                                            <td style="width: 65%;"><?php echo $HQEfxIdMain; ?></td>
                                            </tr>
                                            <tr>
                                            <td style="height:100px;"><b>Company Profile</b></td>
                                            <td><?php
													echo !empty($BusinessName) ? $BusinessName : ' - ';
													echo '<br>'."Legal Business Name : ";
													echo !empty($LegalBusinessName) ? $LegalBusinessName : ' - ';
													echo '<br>'.' '.$HqCompanyAddress;
													echo $HqCompCity.$HqCompState.$HqCompZip;
												?></td>
                                            </tr>
                                            <tr>
                                            <td><b>Telephone</b></td>
                                            <td><?php echo !empty($HQTelephone) ? $HQTelephone : ' - '; ?></td>
                                            </tr>
                                            <tr>
                                            <td><b>Tax ID</b></td>
                                            <td>-</td>
                                            </tr>
                                            <tr>
                                            <td><b>SSN</b></td>
                                            <td>-</td>
                                            </tr>
                                            <tr>
                                            <td><b>Established</b></td>
                                            <td><?php echo !empty($StartedYear) ? $StartedYear : ' - '; ?> </td>
                                            </tr>
                                            <tr>
                                            <td><b>Liability Type</b></td>
                                            <td><?php echo !empty($LiabilityIndicator) ? $LiabilityIndicator : ' - ';?></td>
                                            </tr>
                                            <tr>
                                            <td><b>Ownership</b></td>
                                            <td><?php echo !empty($CompanyOwnership) ? $CompanyOwnership : ' - '; ?></td>
                                            </tr>
                                            <tr>
                                            <td><b>Employees</b></td>
                                            <td><?php echo !empty($NumberOfEmployees) ? $NumberOfEmployees : ' - '; ?> </td>
                                            </tr>
                                            <tr>
                                            <td><b>Location Type</b></td>
                                            <td><?php echo (!empty($HQEfxIdMain)) ? "Headquarters" : ' - '; ?></td>
                                            </tr>
                                            <tr>
                                                <td><b>Annual Sales</b></td>
                                                <td><?php echo (!empty($AnnualSalesRange)) ? $AnnualSalesRange : ' - '; ?></td>
                                            </tr>
                                            <tr>
                                                <td><b>SIC</b></td>
                                                <td><?php echo (!empty($SICCode)) ? $SICCode.', '.$SICDesc : ' - '; ?></td>
                                            </tr>
											<tr>
                                                <td style="height:65px;"><b>NAICS</b></td>
                                                <td><?php echo (!empty($NAICSCode)) ? $NAICSCode.', '.$NAICSDescription : ' - '; ?></td>
                                            </tr>


                                        </table></td>
			        </tr>
		        </table>
	         </td>
        </tr>
        <tr><td colspan="3" style="height:75px;">&nbsp;</td></tr>
        <tr>
            <td colspan="3" class="reportdata">
                <table id="reportdata">
                    <tr>
                        <th colspan="2">Report Highlights</th>
                    </tr>
                    <tr>
                        <td style="width: 50%; background-color:#f2c50c; text-align: left; font-weight: 600; padding-left: 50px;">Since <?php $RecentSinceDate = isset($response_folder['ReportAttributes']['RecentSinceDate']) ? General::getFormatedDate($response_folder['ReportAttributes']['RecentSinceDate']) : "NA"; echo $RecentSinceDate;?> </td>
                        <td style="width: 50%; background-color:#f2c50c; text-align: left; font-weight: 600; padding-left: 50px;">As of <?php echo General::getFormatedDate($response['EfxTransmit']['CommercialCreditReport'][0]['Header']['DateOfRequest']); ?></td>
                    </tr>

                    <tr>
                        <td>Accounts Updated : <?php echo !empty($response_folder['ReportAttributes']['NonFinancialSummary']['SummaryAttributes']['NewUpdates']) ? $response_folder['ReportAttributes']['NonFinancialSummary']['SummaryAttributes']['NewUpdates'] : '-' ;?>
                        </td>
                        <td>Number Of Public Records :
                            <?php
                            $noOfbankrup   = 0;
                            $noOfJudg      = 0;
                            $noOfLiens     = 0;

                            if(!empty($response_folder['ReportAttributes']['PublicRecordsSummary']['NumberOfJudgments'])){
                                $noOfJudg = $response_folder['ReportAttributes']['PublicRecordsSummary']['NumberOfJudgments'];
                            }
                            if(!empty($response_folder['ReportAttributes']['PublicRecordsSummary']['NumberOfLiens'])){
                                $noOfLiens = $response_folder['ReportAttributes']['PublicRecordsSummary']['NumberOfLiens'];
                            }
                            if(!empty($response_folder['ReportAttributes']['PublicRecordsSummary']['NumberOfBankruptcies'])){
                                $noOfbankrup = $response_folder['ReportAttributes']['PublicRecordsSummary']['NumberOfBankruptcies'];
                            }
                            echo $noOfJudg + $noOfLiens +$noOfbankrup;
                            ?>
                        </td>
                    </tr>

                    <tr>
                        <td>Accounts Opened : <?php
                            if(!empty($response_folder['ReportAttributes']['OpenNonFiByIndGroup']['OpenSummaryAttributes'][0]['NumOpenAccts'])){
                                echo $response_folder['ReportAttributes']['OpenNonFiByIndGroup']['OpenSummaryAttributes'][0]['NumOpenAccts'];
                            }else{
                                echo '0';
                            }
                            ?>
                        </td>
                        <td>Open Accounts : <?php
                            if(!empty($response_folder['ReportAttributes']['OpenNonFiByIndGroup']['OpenSummaryAttributesTotals']['NumOpenAccts'])){
                                echo $response_folder['ReportAttributes']['OpenNonFiByIndGroup']['OpenSummaryAttributesTotals']['NumOpenAccts'];
                            }
                            ?>
                        </td>
                    </tr>
                    <tr>
                        <td>Accounts Closed :
                            <?php
                            $closeAcc = 0;
                            if(!empty($response_folder['ReportAttributes']['NonFinancialSummary']['SummaryAttributes']['NumClosed'])){
                                echo $response_folder['ReportAttributes']['NonFinancialSummary']['SummaryAttributes']['NumClosed'];
                            }else{
                                echo $closeAcc = 0;
                            }
                            ?>
                        </td>

                        <td>Closed Accounts :
                            <?php
                            if(!empty($response_folder['ReportAttributes']['ClosedNonFiByIndGroup']['ClosedSummaryAttributesTotals']['NumCurrentAccts'])){
                                echo $response_folder['ReportAttributes']['ClosedNonFiByIndGroup']['ClosedSummaryAttributesTotals']['NumCurrentAccts'];
                            }else{
                                echo '0';
                            }
                            ?>
                        </td>

                    </tr>

                    <tr>
                        <td>Accounts Delinquent : <?php
                            if(!empty($response_folder['ReportAttributes']['NonFinancialSummary']['SummaryAttributes']['NewDelinquencies'])){
                                echo $response_folder['ReportAttributes']['NonFinancialSummary']['SummaryAttributes']['NewDelinquencies'];
                            }else{
                                echo '-';
                            }
                            ?>
                        </td>
                        <td>Total Past Due Amount :
                            <?php echo !empty($response_folder['ReportAttributes']['NonFinancialSummary']['SummaryAttributes']['OpenTotalPastDue']['value']) ? "$" .number_format($response_folder['ReportAttributes']['NonFinancialSummary']['SummaryAttributes']['OpenTotalPastDue']['value']) : '-' ;
                            ?>
                        </td>
                    </tr>
                    <tr>
                        <td>Inquiries : <?php
                            $non_banking_count = array();
                            $non_banking_array = array();
                            $banking_count	   = array();
                            $banking_array     = array();
                            if(!empty($response['EfxTransmit']['CommercialCreditReport'][0]['Folder']['Inquiries'])){
                                foreach($response['EfxTransmit']['CommercialCreditReport'][0]['Folder']['Inquiries'] as $key => $inquery_val){
                                    if($inquery_val['Industry']['value']=='Non-Financial'){
                                        $non_banking_count[] = $inquery_val['Industry']['value'];
                                        $non_banking_array[] = $inquery_val['InquiryDate'];
                                    }else{
                                        $banking_count[] = $inquery_val['Industry']['value'];
                                        $banking_array[] = $inquery_val['InquiryDate'];
                                    }


                                }
                                echo count($non_banking_count)+count($banking_count);
                            } ?>
                        </td>
                        <td>Most Severe Status : <?php
                            if(!empty($response_folder['ReportAttributes']['NonFinancialSummary']['SummaryAttributes']['MostSevereStatus24Months'])){
                                echo $response_folder['ReportAttributes']['NonFinancialSummary']['SummaryAttributes']['MostSevereStatus24Months'];
                            }else{
                                echo '-';
                            }
                            ?></td>
                    </tr>

                    <tr>
                        <td>Most Severe Status :  <?php
                            if(!empty($response_folder['ReportAttributes']['NonFinancialSummary']['SummaryAttributes']['NewMostSevStatus'])){
                                echo $response_folder['ReportAttributes']['NonFinancialSummary']['SummaryAttributes']['NewMostSevStatus']; }else{
                                echo '-';
                            }
                            ?>
                        </td>
                        <?php
                        //looping data at here...

                        $singleHiCreditExtOrBalOwed = array();
                        $singleHighestTotalPastDue  = array();

                        if(!empty($response_folder['ReportAttributes']['OpenNonFiByIndGroup']['OpenSummaryAttributes'])){

                            foreach($response_folder['ReportAttributes']['OpenNonFiByIndGroup']['OpenSummaryAttributes'] as $key => $grp_dtl){

                                $singleHiCreditExtOrBalOwed[] = $grp_dtl['SingleHiCreditExtOrBalOwed'];
                                $singleHighestTotalPastDue[]  = $grp_dtl['SingleHighestTotalPastDue'];
                            }
                        }
                        //ends of data looping.

                        $all_payment_history = array();
                        $i = 0;

                        $var2 =10;
                        $creditLimitAmtSum        = array();
                        $creditLimitBalanceAmtSum = array();
                        $arrayAccOpenDate 		  = array();
                        $sumOfYrsAllOpenAcc       = 0;
                        $sumCreditUsageAmt        = array();
                        $arrNonFinAccPaymentHistryParams   = array();
                        $arrFinAccPaymentHistryParams      	   = array();
                        $arrNonFinClosedAccPaymentHistryParams = array();
                        $arrAccPaymentHistryAllAcc = array();
                        //AcctOpenedDate


                        if(!empty($response['EfxTransmit']['CommercialCreditReport'][0]['Folder']['TradeInfo'])){
                            foreach($response['EfxTransmit']['CommercialCreditReport'][0]['Folder']['TradeInfo'] as $key => $trade_val){

                                //Creating array only for NonFinancial Account.
                                if(!empty($trade_val['CurrentTrade']['NonFiAcctInd']) && $trade_val['CurrentTrade']['NonFiAcctInd']=="Y" && $trade_val['CurrentTrade']['FiAcctInd']=="N"){

                                    $creditLimitAmtSum[]  = $trade_val['CurrentTrade']['HiCreditOrOrigLoanAmount']['value'];
                                    $creditLimitBalanceAmtSum[] = $trade_val['CurrentTrade']['BalanceAmount']['value'];

                                    $sumCreditUsageAmt[] = $trade_val['CurrentTrade']['HiCreditOrOrigLoanAmount']['value'] - $trade_val['CurrentTrade']['BalanceAmount']['value'];

                                    $arrayAccOpenDate[] = $trade_val['CurrentTrade']['AcctOpenedDate'];
                                    $sumOfYrsAllOpenAcc+= General::getNumberOfYearsFromDate(date("m/d/Y"), $trade_val['CurrentTrade']['AcctOpenedDate']);

                                    $reportedDate = !empty($trade_val['CurrentTrade']['TraitActivity']['ReportedDate']) ? $trade_val['CurrentTrade']['TraitActivity']['ReportedDate'] : '';
                                }


                                //Creating array only for NonFinancial Account.
                                if(!empty($trade_val['CurrentTrade']['NonFiAcctInd']) && $trade_val['CurrentTrade']['NonFiAcctInd']=="Y"  && $trade_val['CurrentTrade']['ClosedInd'] == "N"){

                                    $arrNonFinAccPaymentHistryParams[] = array("IndustryGroup"=> $trade_val['CurrentTrade']['TraitActivity']['InformationSource']['IndustryGroup'], "ReportedDate"=> $reportedDate,
                                        "AccountReferenceNo"=> $trade_val['CurrentTrade']['AccountReference']['value'], "HiCreditOrOrigLoanAmount"=> $trade_val['CurrentTrade'][  'HiCreditOrOrigLoanAmount']['value'],
                                        "BalanceAmount"=> $trade_val['CurrentTrade']['BalanceAmount']['value'], "AgingStatus"=> $trade_val['CurrentTrade']['AgingStatus'], "PaymentHistoryProfile"=> $trade_val['CurrentTrade']['PaymentHistoryProfile'],"OpenInd"=> $trade_val['CurrentTrade']['OpenInd'], "ClosedInd"=> $trade_val['CurrentTrade']['ClosedInd'], "NonFiAcctInd"=>$trade_val['CurrentTrade']['NonFiAcctInd'] );

                                }

                                //get all accounts payment History.
                                if(!empty($trade_val['CurrentTrade']['NonFiAcctInd'])){
                                    $arrAccPaymentHistryAllAcc[] = $trade_val['CurrentTrade']['PaymentHistoryProfile'];
                                }

                                //Creating array only for NonFinancial Account.
                                if(!empty($trade_val['CurrentTrade']['FiAcctInd']) && $trade_val['CurrentTrade']['FiAcctInd']=="Y"){

                                    $arrFinAccPaymentHistryParams[] = array("IndustryGroup"=> $trade_val['CurrentTrade']['TraitActivity']['InformationSource']['IndustryGroup'], "ReportedDate"=> $reportedDate,
                                        "AccountReferenceNo"=> $trade_val['CurrentTrade']['AccountReference']['value'], "HiCreditOrOrigLoanAmount"=> $trade_val['CurrentTrade'][  'HiCreditOrOrigLoanAmount']['value'],
                                        "BalanceAmount"=> $trade_val['CurrentTrade']['BalanceAmount']['value'], "AgingStatus"=> $trade_val['CurrentTrade']['AgingStatus'], "PaymentHistoryProfile"=> $trade_val['CurrentTrade']['PaymentHistoryProfile'],"OpenInd"=> $trade_val['CurrentTrade']['OpenInd'], "ClosedInd"=> $trade_val['CurrentTrade']['ClosedInd'], "NonFiAcctInd"=>$trade_val['CurrentTrade']['NonFiAcctInd'] );

                                }

                                //Creating array only for NonFinancial Account.
                                if(!empty($trade_val['CurrentTrade']['NonFiAcctInd']) && $trade_val['CurrentTrade']['NonFiAcctInd']=="Y" && $trade_val['CurrentTrade']['ClosedInd'] == "Y"){

                                    $arrNonFinClosedAccPaymentHistryParams[] = array("IndustryGroup"=> $trade_val['CurrentTrade']['TraitActivity']['InformationSource']['IndustryGroup'], "ReportedDate"=> $reportedDate,
                                        "AccountReferenceNo"=> $trade_val['CurrentTrade']['AccountReference']['value'], "HiCreditOrOrigLoanAmount"=> $trade_val['CurrentTrade'][  'HiCreditOrOrigLoanAmount']['value'],
                                        "BalanceAmount"=> $trade_val['CurrentTrade']['BalanceAmount']['value'], "AgingStatus"=> $trade_val['CurrentTrade']['AgingStatus'], "PaymentHistoryProfile"=> $trade_val['CurrentTrade']['PaymentHistoryProfile'],"OpenInd"=> $trade_val['CurrentTrade']['OpenInd'], "ClosedInd"=> $trade_val['CurrentTrade']['ClosedInd'], "NonFiAcctInd"=>$trade_val['CurrentTrade']['NonFiAcctInd'] );

                                }

                                /*$arrFinAccPaymentHistryParams[] = array("IndustryGroup"=> , "ReportedDate"=> , "AccountReferenceNo"=> , "HiCreditOrOrigLoanAmount"=> , "BalanceAmount"=> , "AgingStatus"=> , "PaymentHistoryProfile"=> ,"OpenInd"=> , "ClosedInd"=> , "NonFiAcctInd"=>"" );*/

                                $org_name =
                                $all_payment_history[] ="Group-".$i.':'.$trade_val['CurrentTrade']['PaymentHistoryProfile'] ;
                                $i = $i+1;
                            }

                        }


                        //dd($arrayAccOpenDate);

                        //calculataion of values.
                        //$arrAllZeros = array();
                        //$arrAllBs	 = array();
                        $arrOnTimePayment	 = array();
                        $arrDelayPayment	 = array();
                        $arrOfTotalMonths	 = array();

                        foreach($arrAccPaymentHistryAllAcc as $key =>$payHis_val)
                        {

                            $data = $payHis_val;
                            $formatted = implode(',',str_split($data));
                            $array = explode(",",$formatted);
                            foreach($array as $val)
                            {
                                if($val==0 || $val=="B" || $val=="C" || $val==7){
                                    $arrOnTimePayment [] = $val;
                                    $arrOfTotalMonths [] = $val;
                                }else{
                                    $arrDelayPayment[]   = $val;
                                    $arrOfTotalMonths [] = $val;
                                }
                            }
                        }

                        //echo '<pre>';
                        //print_r($arrAllZeros);
                        //echo "On-TIME=SUM=".count($arrOnTimePayment).'<br>';
                        //echo "DELAY=SUM=".count($arrDelayPayment).'<br>';
                        //echo '<pre>';
                        //print_r($arrAllBs);
                        //dd($arrAccPaymentHistryAllAcc);
                        //dd($arrNonFinClosedAccPaymentHistryParams);
                        //echo "SUM_CRET_USAGE_AMT".array_sum($sumCreditUsageAmt);
                        //echo "SUM_CRET_BALANCE_LIMIT".array_sum($creditLimitBalanceAmtSum);
                        //dd($sumOfYrsAllOpenAcc)/count($arrayAccOpenDate);
                        //dd(array_slice($all_payment_history, -2 ));
                        ?>

                        <td>Single Highest Balance Due : <?php
                            if(!empty($response_folder['ReportAttributes']['NonFinancialSummary']['SummaryAttributes']['OpenTotalPastDue']['value'])){

                                echo !empty($singleHighestTotalPastDue) ? "$" .number_format(max($singleHighestTotalPastDue)) : '-';
                                //echo "$" .number_format($response_folder['ReportAttributes']['NonFinancialSummary']['SummaryAttributes']['OpenTotalPastDue']['value']);
                            }
                            ?></td>
                    </tr>

                    <tr>
                        <td>Charge Off Amount :
                            <?php
                            if(!empty($response_folder['ReportAttributes']['NonFinancialSummary']['SummaryAttributes']['ChargeOffAmt']['value'])){
                                echo "$" .number_format($response_folder['ReportAttributes']['NonFinancialSummary']['SummaryAttributes']['ChargeOffAmt']['value']);
                            }else {
                                echo '$0';
                            }
                            ?>
                        </td>

                        <td>Total Current Credit Exposure : <?php
                            if(!empty($response_folder['ReportAttributes']['NonFinancialSummary']['SummaryAttributes']['TotalExposure']['value'])){
                                echo "$" .number_format($response_folder['ReportAttributes']['NonFinancialSummary']['SummaryAttributes']['TotalExposure']['value']);
                            }else{
                                echo "-";
                            }
                            ?></td>
                    </tr>

                    <tr>
                        <td>Highest Credit Extended : <?php
                            if(!empty($response_folder['ReportAttributes']['NonFinancialSummary']['SummaryAttributes']['NewHiCreditExt']['value'])){
                                echo "$" .number_format($response_folder['ReportAttributes']['NonFinancialSummary']['SummaryAttributes']['NewHiCreditExt']['value']);
                            }else{
                                echo '-';
                            }
                            ?>
                        </td>
                        <td>Highest Credit Extended :
                            <?php echo !empty($response_folder['ReportAttributes']['NonFinancialSummary']['SummaryAttributes']['HighestCredit']['value']) ? "$" .number_format($response_folder['ReportAttributes']['NonFinancialSummary']['SummaryAttributes']['HighestCredit']['value']) : '-';
                            ?>
                        </td>
                    </tr>

                    <tr>
                        <td></td>
                        <td> </td>
                    <!--<td>Number Of Public Records:
						<?php
                    $noOfbankrup   = 0;
                    $noOfJudg      = 0;
                    $noOfLiens     = 0;

                    if(!empty($response_folder['ReportAttributes']['PublicRecordsSummary']['NumberOfJudgments'])){
                        $noOfJudg = $response_folder['ReportAttributes']['PublicRecordsSummary']['NumberOfJudgments'];
                    }
                    if(!empty($response_folder['ReportAttributes']['PublicRecordsSummary']['NumberOfLiens'])){
                        $noOfLiens = $response_folder['ReportAttributes']['PublicRecordsSummary']['NumberOfLiens'];
                    }
                    if(!empty($response_folder['ReportAttributes']['PublicRecordsSummary']['NumberOfBankruptcies'])){
                        $noOfbankrup = $response_folder['ReportAttributes']['PublicRecordsSummary']['NumberOfBankruptcies'];
                    }
                    echo $noOfJudg + $noOfLiens +$noOfbankrup;
                    ?>
                        </td> -->
                    </tr>

                </table>
            </td>
        </tr>
        <tr>
            <td colspan="3" style="height:30px;"><div style="page-break-after: always"></div></td>
        </tr>
        <tr>
            <td colspan="3" class="publicdeeds">
                <table id="publicdeeds">
                    <tr>
                        <th colspan="3">Public Records Summary</th>
                    </tr>
                    <tr>
                        <td style="width: 33%;"><?php
                            if(!empty($response_folder['ReportAttributes']['PublicRecordsSummary']['NumberOfJudgments'])){
                               // echo ngettext('Judgements', 'Judgementss', $response_folder['ReportAttributes']['PublicRecordsSummary']['NumberOfJudgments']);
                               echo "Judgements";
                            }else{
                                echo "Judgements";
                            }
                            ?> </td>
                        <td style="width: 33%;">
                            <?php
                            if(!empty($response_folder['ReportAttributes']['PublicRecordsSummary']['NumberOfLiens'])){
                               // echo ngettext('Lien', 'Liens', $response_folder['ReportAttributes']['PublicRecordsSummary']['NumberOfLiens']);
                               echo "Liens";
                            }else{

                                echo "Liens";
                            }
                            ?>
                        </td>
                        <td style="width: 33%;">
                            <?php
                            if(!empty($response_folder['ReportAttributes']['PublicRecordsSummary']['NumberOfBankruptcies'])){
                               // echo ngettext('Bankruptcies', 'Bankruptcies', $response_folder['ReportAttributes']['PublicRecordsSummary']['NumberOfBankruptcies']);
                               echo 'Bankruptcies';
                            }else{
                                echo 'Bankruptcies';
                            }
                            ?>
                        </td>
                    </tr>
                    <tr>
                        <td style="width: 33%;">
                            <?php if(!empty($response_folder['ReportAttributes']['PublicRecordsSummary']['NumberOfJudgments'])){
                                echo $response_folder['ReportAttributes']['PublicRecordsSummary']['NumberOfJudgments']; }else{ echo '0' ;} ?>
                        </td>
                        <td style="width: 33%;">
                            <?php if(!empty($response_folder['ReportAttributes']['PublicRecordsSummary']['NumberOfLiens'])){
                                echo $response_folder['ReportAttributes']['PublicRecordsSummary']['NumberOfLiens'];
                            }else{ echo '0' ;}
                            ?>
                        </td>

                        <td style="width: 33%;">
                            <?php if(!empty($response_folder['BankruptciesTrait'])){
                                echo count($response_folder['BankruptciesTrait']);
                            }else{ echo '0'; }
                            ?>
                        </td>
                    </tr>
                </table>
            </td>
        </tr>

        <tr>
            <td colspan="3" class="creditage">
                <table id="publicdeeds2">
                    <tr>
                        <th colspan="7">Public Record Details</th>
                    </tr>
                    <tr>
                        <td style="width: 16%; background-color:#f2c50c; text-align: left; font-weight: 600; ">Type</td>
                        <td style="width: 15%; background-color:#f2c50c; text-align: left; font-weight: 600; ">Plaintiff</td>
                        <td style="width: 15%; background-color:#f2c50c; text-align: left; font-weight: 600; ">Defendant</td>
                        <td style="width: 16%; background-color:#f2c50c; text-align: left; font-weight: 600; ">Ref Number</td>
                        <td style="width: 16%; background-color:#f2c50c; text-align: left; font-weight: 600; ">Date</td>
                        <td style="width: 16%; background-color:#f2c50c; text-align: left; font-weight: 600; ">Amount</td>
                        <td style="width: 16%; background-color:#f2c50c; text-align: left; font-weight: 600; ">Status</td>
                    </tr>
                    <br/>
                <?php
                    if(!empty($response_folder['JudgmentTrait'])){ ?>

                    <?php
                    if(!empty($response_folder['JudgmentTrait'])){
                    $isJudgments = false;
                    $Jud_value   = "";

					$counter_jud = 1;
                    foreach($response_folder['JudgmentTrait'] as $key => $Jud_value){
					//code for page break
					if($counter_jud%15==0){
                        echo '<table id="paymenthistory" style="page-break-after: always;"><tr>';
					}else{
						echo '<table id="paymenthistory"><tr>';
					}
					?>
					<td>
							<?php
							if($isJudgments==false){
							echo "Judgments";
							$isJudgments =true;
							}
							?>
					</td>

                        <td>
                        <?php
                        if(!empty($Jud_value['PublicRecordID'][1]) && $Jud_value['PublicRecordID'][1]['DebtorCode']=="Plaintiff"){
                        echo $Jud_value['PublicRecordID'][1]['Folder']['IdTrait'][0]['CompanyNameTrait'][0]['BusinessName'];
                        }?>
                        </td>

                        <td>
                        <?php
                        if(!empty($Jud_value['PublicRecordID'][0]) && $Jud_value['PublicRecordID'][0]['DebtorCode']=="Defendant"){
                        echo $Jud_value['PublicRecordID'][0]['Folder']['IdTrait'][0]['CompanyNameTrait'][0]['BusinessName'];
                        }
                        ?>
                        </td>

                        <td>
                        <?php echo !empty($Jud_value['CurrentPublicRecord']['CaseNumber']) ? $Jud_value['CurrentPublicRecord']['CaseNumber'] : ''; ?>
                        </td>

                        <td>
                        <?php echo !empty($Jud_value['CurrentPublicRecord']['FilingDate']) ? General::getFormatedDate($Jud_value['CurrentPublicRecord']['FilingDate']) : ' - '; ?>
                        </td>

                        <td>
                        <?php echo !empty($Jud_value['CurrentPublicRecord']['TotalLiabilities']['value']) ? "$" .number_format($Jud_value['CurrentPublicRecord']['TotalLiabilities']['value']) : '$0'; ?>
                        </td>

                        <td>
                        <?php echo !empty($Jud_value['CurrentPublicRecord']['DispositionStatus']) ? $Jud_value['CurrentPublicRecord']['DispositionStatus'] : ''; ?>
                        </td>

                    </tr>
					</table>
                    <?php
					$counter_jud++;
                    }

                    }
                    }
                    ?>
                    <br/>


                    <?php
                    //Code For Lien.
                    if(!empty($response_folder['LienTrait'])){
                    $isLiens = false;
					$counter_liens = 1;
                    foreach($response_folder['LienTrait'] as $key => $Lien_value){
					//code for page break
					if($counter_liens%15==0){
                        echo '<table id="paymenthistory" style="page-break-after: always;"><tr>';
					}else{
						echo '<table id="paymenthistory"><tr>';
					}
					?>

                        <td>
                        <?php
                        if($isLiens==false){
                        //echo ngettext('Lien', 'Liens', $response_folder['ReportAttributes']['PublicRecordsSummary']['NumberOfLiens']);
                        echo 'Liens';
                        $isLiens =true;
                        }
                        ?>
                        </td>

                        <td>
                        <?php
                        if(!empty($Lien_value['PublicRecordID'][1]) && $Lien_value['PublicRecordID'][1]['DebtorCode']=="Plaintiff"){
                        echo $Lien_value['PublicRecordID'][1]['Folder']['IdTrait'][0]['CompanyNameTrait'][0]['BusinessName'];
                        }
                        ?>
                        </td>

                        <td>
                        <?php
                        if(!empty($Lien_value['PublicRecordID'][0]) && $Lien_value['PublicRecordID'][0]['DebtorCode']=="Defendant"){
                        echo $Lien_value['PublicRecordID'][0]['Folder']['IdTrait'][0]['CompanyNameTrait'][0]['BusinessName'];
                        }
                        ?>
                        </td>

                        <td>
                        <?php echo !empty($Lien_value['CurrentPublicRecord']['CaseNumber']) ? $Lien_value['CurrentPublicRecord']['CaseNumber'] : ''; ?>
                        </td>

                        <td>
                        <?php echo !empty($Lien_value['CurrentPublicRecord']['FilingDate']) ? General::getFormatedDate($Lien_value['CurrentPublicRecord']['FilingDate']) : ' - ';
                        ?>
                        </td>

                        <td>
                        <?php echo !empty($Lien_value['CurrentPublicRecord']['TotalLiabilities']['value']) ? "$" .number_format($Lien_value['CurrentPublicRecord']['TotalLiabilities']['value']) : '$0'; ?>
                        </td>

                        <td>
                        <?php echo !empty($Lien_value['CurrentPublicRecord']['DispositionStatus']) ? $Lien_value['CurrentPublicRecord']['DispositionStatus'] : ''; ?>
                        </td>

                    </tr>
					</table>
                    <?php
					$counter_liens++;
                        }
                        }

                    //Code For Bankruptcies
                    if(!empty($response_folder['BankruptciesTrait'])){ ?>
                    <br/>

                    <tr>
                        <?php
                        if(!empty($response_folder['BankruptciesTrait'])){

                        $isBankruptcies=false;
                        $counter_bank =1;
                        foreach($response_folder['BankruptciesTrait'] as $key => $Bky_value){

                            if($counter_bank%15==0){
                                echo '<table id="paymenthistory" style="page-break-after: always;"><tr>';
                            }else{
                                echo '<table id="paymenthistory"><tr>';
                            }

                            ?>

                        <td>
                            <?php
                            if($isBankruptcies==false){
                                echo "Bankruptcies";
                                $isBankruptcies =true;
                            }
                            ?>
                        </td>
                        <td>
                            <?php
                            if(!empty($Bky_value['PublicRecordID'][2]['DebtorCode']) && $Bky_value['PublicRecordID'][2]['DebtorCode']=="Trustee"){

                                echo $Bky_value['PublicRecordID'][2]['Folder']['IdTrait'][0]['CompanyNameTrait'][0]['BusinessName'];
                            }
                            ?>
                        </td>
                        <td>
                            <?php
                            if(!empty($Bky_value['PublicRecordID'][0]['DebtorCode']) && $Bky_value['PublicRecordID'][0]['DebtorCode']=="Defendant"){
                                echo $Bky_value['PublicRecordID'][0]['Folder']['IdTrait'][0]['CompanyNameTrait'][0]['BusinessName'];
                            }
                            ?>
                        </td>
                        <td>
                            <?php echo !empty($Bky_value['CurrentPublicRecord']['CaseNumber']) ? 'XXXXXXX' : ''; ?>
                        </td>

                        <td>
                            <?php
                            if(!empty($Bky_value['CurrentPublicRecord']['FilingDate'])){
                                echo General::getFormatedDate($Bky_value['CurrentPublicRecord']['FilingDate']);
                            }else{
                                echo ' - ';
                            }
                            ?>
                        </td>
                        <td>
                            <?php echo !empty($Bky_value['CurrentPublicRecord']['TotalLiabilities']['value']) ? "$" .number_format($Bky_value['CurrentPublicRecord']['TotalLiabilities']['value']) : '$0'; ?>
                        </td>

                        <td>
                            <?php
                            if(!empty($Bky_value['CurrentPublicRecord']['DispositionStatus'])){
                                echo $Bky_value['CurrentPublicRecord']['DispositionStatus'];
                            } ?>
                        </td>

                    </tr>
                    <?php
                    $counter_bank++;
                    }
                    }
                    }
                    ?>
                </table>
            </td>
        </tr>
        <tr>
            <td colspan="3">&nbsp;</td>
        </tr>

        <!-- CODE AGAIN ADDED OVER HERE -->
        <?php
         if((!empty($response_folder['ReportAttributes']['PublicRecordsSummary']['NumberOfLiens']) && $response_folder['ReportAttributes']['PublicRecordsSummary']['NumberOfLiens']>10) || (!empty($response_folder['ReportAttributes']['PublicRecordsSummary']['NumberOfJudgments']) && $response_folder['ReportAttributes']['PublicRecordsSummary']['NumberOfJudgments']>10)){
         echo '<div style="page-break-after: always"></div>';
        } ?>

		<tr>
            <td colspan="3">
                <table width="100%" >
                    <tr>
                        <td valign="top" colspan="3" style="height:100px;">
                            <div class="non-headtxt"><h2>Non-Banking</h2>
                                <span></span>
                        </td>
                    </tr>
                    <!-- Non Banking Blocks-->
                    <?php

                    //array of account open dates.
                    if(!empty($arrayAccOpenDate)){

                        $date_arr =$arrayAccOpenDate;
                        for ($i = 0; $i < count($date_arr); $i++)
                        {
                            if ($i == 0)
                            {
                                $max_date = date('Y-m-d H:i:s', strtotime($date_arr[$i]));
                                $min_date = date('Y-m-d H:i:s', strtotime($date_arr[$i]));
                            }
                            else if ($i != 0)
                            {
                                $new_date = date('Y-m-d H:i:s', strtotime($date_arr[$i]));
                                if ($new_date > $max_date)
                                {
                                    $max_date = $new_date;
                                }
                                else if ($new_date < $min_date)
                                {
                                    $min_date = $new_date;
                                }
                            }
                        }
                        //echo date('d-m-Y',strtotime($max_date));
                        //echo date('d-m-Y',strtotime($min_date));
                    }
                    ?>
                    <tr>
                        <td valign="top" width="33.3%">
                            <div class="statistics_item">
                                <h3 class="counter">
                                    <?php
                                    if(!empty($arrayAccOpenDate)){

                                        $maxDate = date('d-m-Y',strtotime($min_date));
                                        echo $maxYrs  = General::getNumberOfYearsFromDate(date("m/d/Y"), $maxDate);
                                        echo  '<span>'.$maxYrs == 1 ? 'yr':' yrs'.'</span>';
                                    }else{
                                        echo "NA";
                                    }

                                    ?></h3>
                                <p>Credit Age</p>
                            </div>
                        </td>
                        <td valign="top" width="33.3%">
                            <div class="statistics_item">
                                <h3 class="counter">
                                    <?php
                                    $sumVal = "";
                                    if(!empty($creditLimitAmtSum) && !empty($creditLimitBalanceAmtSum)){
                                        $sumVal = array_sum($creditLimitBalanceAmtSum)/array_sum($creditLimitAmtSum)*100;
                                        echo round($sumVal,0,PHP_ROUND_HALF_UP).'<span>'.'%'.'</span>';
                                    }else{
                                        echo "NA";
                                    }
                                    ?>
                                </h3>
                                <p>Credit Usage</p>
                            </div>
                        </td>
                        <td valign="top" width="33.3%">
                            <div class="statistics_item">
                                <h3 class="counter">
                                    <?php echo count($non_banking_count); ?>
                                </h3>
                                <p>Enquires</p>
                            </div>
                        </td>
                    </tr>
                    <tr>
                        <td valign="top" width="33.3%">
                            <div class="statistics_item">
                                <h3 class="counter">
                                    <?php

                                    $avgPayCnt = "";
                                    if(!empty($arrOnTimePayment) && !empty($arrOfTotalMonths)){

                                        $avgPayCnt =  count($arrOnTimePayment)/count($arrOfTotalMonths)*100;
                                        echo round($avgPayCnt,0,PHP_ROUND_HALF_UP).'%';
                                    }else{
                                        echo "NA";
                                    }
                                    ?>
                                </h3>
                                <p>Payment Score</p>
                            </div>
                        </td>
                        <td valign="top" width="33.3%">
                            <div class="statistics_item">
                                <h3 class="counter"><?php if(!empty($response_folder['ReportAttributes']['NonFinancialSummary']['SummaryAttributes']['NumberOfAccounts'])){ echo $response_folder['ReportAttributes']['NonFinancialSummary']['SummaryAttributes']['NumberOfAccounts']; }else{ echo "NA"; } ?></h3>
                                <p>Total Accounts</p>
                            </div>
                        </td>
                        <td valign="top" width="33.3%">&nbsp;</td>
                    </tr>
</div>
<!-- Non Banking blocks Ends-->
</td>
</tr>

<tr>
    <td colspan="3">
        <!-- HR Line-->
        <div class="row">
            <div class="col-md-12"  style="height:30px; padding:12px 0px"></div>
        </div>
    </td>
</tr>

<tr>
    <td colspan="3">
        <!-- Credit Age Summary -->
        <table valign="top" width="100%">
            <tr>
                <td valign="top" style="width:20%;">&nbsp;</td>
                <td valign="top" style="width:80%;" class="publicdeeds">
                    <table id="publicdeeds" style="width:100%">
                        <tr>
                            <th colspan="2">Credit Age Summary</th>
                        </tr>
                        <tr>
                            <td style="width: 50%;">Oldest Account</td>
                            <td style="width: 50%;">
                                <?php
                                if(!empty($arrayAccOpenDate)){

                                    $maxDate = date('d-m-Y',strtotime($min_date));
                                    echo $maxYrs  = General::getNumberOfYearsFromDate(date("m/d/Y"), $maxDate);
                                    echo $yearText = $maxYrs == 1 ? 'yr':' yrs';
                                }
                                ?>
                            </td>
                        </tr>
                        <tr>
                            <td>Newest Account</td>
                            <td><?php

                                /*echo $minDate = date('d-m-Y',strtotime($max_date));
                                //use Carbon\Carbon;
                                echo $date1 = "2020-02-29";
                                //$date2 = "2009-06-26";
                                echo $date2 = date('Y-m-d');
                                echo $diff  = abs(strtotime($date2) - strtotime($date1));
                                echo $years = floor($diff / (365*60*60*24)) . "=No. Of Yrs";

                                $d1 = new DateTime('2021-02-18');
                                $d2 = new DateTime('2020-03-29');
                                $diff = $d2->diff($d1);
                                echo "YRS=" . $diff->y . "=YRS";
                                */
                                //$startDate = Carbon::parse($date1);
                                //$endDate   = Carbon::parse($date2);
                                //echo $diff      = $startDate->diffInYears($endDate);

                                //$datetime1 = new DateTime("3-28-2020");
                                //$datetime2 = new DateTime("2-18-2021");
                                //$difference = $datetime1->diff($datetime2);
                                //echo "<br>";
                                //echo 'Difference: '.$difference->y.'=NEXT';

                                if(!empty($arrayAccOpenDate)){

                                    $minDate = date('d-m-Y',strtotime($max_date));
                                    $minYrs  = General::getNumberOfYearsFromDate(date("m/d/Y"), $minDate);
                                    if($minYrs==0){
                                        echo $minYrs = "1";
                                    }else{
                                        echo $minYrs;
                                    }
                                    echo $yearText = $minYrs == 1 ? ' yr':' yrs';
                                }
                                ?></td>
                        </tr>
                        <tr>
                            <td>Average Account</td>
                            <td>
                                <?php
                                $avgCnt = "";
                                if(!empty($sumOfYrsAllOpenAcc) && !empty($arrayAccOpenDate)){
                                    $avgCnt =  $sumOfYrsAllOpenAcc/count($arrayAccOpenDate);
                                    echo round($avgCnt,0,PHP_ROUND_HALF_UP);
                                    echo $avgCnt == 1 ? ' yr':' yrs';
                                }

                                ?>
                            </td>
                        </tr>
                    </table>
                </td>
                <td valign="top" style="width:20%;">&nbsp;</td>
            </tr>
        </table>
        <div class="row">
            <!--<div class="col-md-12 creditage">
                <table id="creditage">
                <tr>
                    <th colspan="2">Credit Age Details</th>
                </tr>
                <tr>
                    <td style="width: 50%; background-color:#f2c50c; text-align: center; font-weight: 600; ">Account</td>
                    <td style="width: 50%; background-color:#f2c50c; text-align: center; font-weight: 600; ">Credit Age</td>
                </tr>
                <tr>
                    <td>Communications</td>
                    <td>1 year </td>
                </tr>
                <tr>
                    <td>Wholesale Trade-Durable Goods</td>
                    <td>2 years </td>
                </tr>
                <tr>
                    <td>Business Services and All Other</td>
                    <td>31 years </td>
                </tr>
                </table>
            </div>-->
        </div>
        <!--Credit Age Summary Ends-->
    </td>
</tr>

<tr>
    <td colspan="3">
        <!-- HR Line-->
        <div class="row">
            <div class="col-md-12"  style="height:30px; padding:12px 0px"></div>
        </div>
    </td>
</tr>

<tr>
    <td colspan="3">
        <!-- Credit usage Summary -->
        <table valign="top" width="100%">
            <tr>
                <td valign="top" style="width:20%;">
                    <!--<div class="donutchart1">
                        <h3>Credit Usage</h3>
                        <canvas id="chDonut9"></canvas>
                        <div class="pie-value-txt1">
                            <span class="pie-value1"><strong></strong><br/>Excellent</span>
                        </div>
                    </div>-->
                </td>
                <td valign="top" style="width:80%;" class="publicdeeds">
                    <table id="publicdeeds" style="width:100%">
                        <tr>
                            <th colspan="2">Credit Usage Summary</th>
                        </tr>
                        <tr>
                            <td style="width: 50%;">Total usage
                                <?php
                                $sumVal = "";
                                if(!empty($creditLimitAmtSum) && !empty($creditLimitBalanceAmtSum)){
                                    $sumVal = array_sum($creditLimitBalanceAmtSum)/array_sum($creditLimitAmtSum)*100;
                                    echo '('. round($sumVal,0,PHP_ROUND_HALF_UP).'<span>'.'%'.'</span>'.')';
                                }
                                ?>
                            </td>
                            <td style="width: 50%;">
                                <?php echo !empty($creditLimitBalanceAmtSum) ? "$" .number_format(array_sum($creditLimitBalanceAmtSum)) : '' ;?>
                            </td>
                        </tr>
                        <tr>
                            <td>Total limit <?php echo !empty($creditLimitAmtSum) ? '' : '' ?></td>
                            <td>
                                <?php
                                if(!empty($creditLimitAmtSum)){
                                    echo "$" . number_format(array_sum($creditLimitAmtSum));
                                }
                                ?>
                            </td>
                        </tr>

                    </table>
                </td>
                <td valign="top" style="width:20%;">&nbsp;</td>
            </tr>
        </table>

        <div class="row">
            <!--<div class="col-md-12 creditage">
                <table id="creditage">
                <tr>
                    <th colspan="4">Credit Usage Details</th>
                </tr>
                <tr>
                    <td style="width: 25%; background-color:#f2c50c; text-align: center; font-weight: 600; ">Account</td>
                    <td style="width: 25%; background-color:#f2c50c; text-align: center; font-weight: 600; ">Credit Age</td>
                    <td style="width: 25%; background-color:#f2c50c; text-align: center; font-weight: 600; ">Limit</td>
                    <td style="width: 25%; background-color:#f2c50c; text-align: center; font-weight: 600; ">Usage</td>
                </tr>
                <tr>
                    <td>-</td>
                    <td>- </td>
                    <td>- </td>
                    <td>-</td>
                </tr>

                </table>
            </div>-->
        </div>
        <!--Credit usage Summary Ends-->
    </td>
</tr>

<tr>
    <td colspan="3">
        <!-- HR Line-->
        <div class="row">
            <div class="col-md-12" style="height:30px; padding:12px 0px"></div>
        </div>
    </td>
</tr>

<tr>
    <td colspan="3">
        <!-- Total Accounts Summary  -->
        <table valign="top" width="100%">
            <tr>
                <td valign="top" style="width:20%;">
                <!--<div class="donutchart1">
													<h3>Total Accounts</h3>
													<canvas id="chDonut11"></canvas>
													<div class="pie-value-txt1">
														<span class="pie-value1"><strong><?php
                /*if(!empty($response_folder['ReportAttributes']['OpenNonFiByIndGroup']['OpenSummaryAttributesTotals']['NumOpenAccts']) && !empty($response_folder['ReportAttributes']['ClosedNonFiByIndGroup']['ClosedSummaryAttributesTotals']['NumCurrentAccts']) && !empty($response_folder['ReportAttributes']['ClosedNonFiByIndGroup']['ClosedSummaryAttributesTotals']['NumDelinquentAccts']))
                {
                echo $response_folder['ReportAttributes']['OpenNonFiByIndGroup']['OpenSummaryAttributesTotals']['NumOpenAccts']+$response_folder['ReportAttributes']['ClosedNonFiByIndGroup']['ClosedSummaryAttributesTotals']['NumCurrentAccts']+$response_folder['ReportAttributes']['ClosedNonFiByIndGroup']['ClosedSummaryAttributesTotals']['NumDelinquentAccts'];
                }*/
                ?></strong><br/>Fair</span>
														</div>
												</div>-->
                </td>
                <td valign="top" style="width:80%;" class="totalaccount">
                    <table id="totalaccount" style="width:100%">
                        <tr>
                            <th colspan="5">Total Accounts Summary</th>
                        </tr>

                        <?php

                            $totalAccVal = 0;

                            $NumOpenAccts = !empty($response_folder['ReportAttributes']['OpenNonFiByIndGroup']['OpenSummaryAttributesTotals']['NumOpenAccts']) ? $response_folder['ReportAttributes']['OpenNonFiByIndGroup']['OpenSummaryAttributesTotals']['NumOpenAccts']: 0;

                            $NumCurrentAccts = !empty($response_folder['ReportAttributes']['ClosedNonFiByIndGroup']['ClosedSummaryAttributesTotals']['NumCurrentAccts']) ? $response_folder['ReportAttributes']['ClosedNonFiByIndGroup']['ClosedSummaryAttributesTotals']['NumCurrentAccts'] : 0;

                            $NumDelinquentAccts = !empty($response_folder['ReportAttributes']['ClosedNonFiByIndGroup']['ClosedSummaryAttributesTotals']['NumDelinquentAccts']) ? $response_folder['ReportAttributes']['ClosedNonFiByIndGroup']['ClosedSummaryAttributesTotals']['NumDelinquentAccts'] : 0;

                            $totalAccVal = $NumOpenAccts + $NumCurrentAccts + $NumDelinquentAccts;                       
                        ?>

                        <tr>
                            <td colspan="5" style="background-color: #e8e8e8;">Busniess Entity - Total
                                <?php //echo ngettext('Account', 'Accounts', $totalAccVal).'  - '. $totalAccVal;
                                echo "Accounts"; ?></td></tr>
                        <tr>
                            <?php
                            $openAccVal = 0;
                            if(!empty($response_folder['ReportAttributes']['OpenNonFiByIndGroup']['OpenSummaryAttributesTotals']['NumOpenAccts'])){
                                $openAccVal = $response_folder['ReportAttributes']['OpenNonFiByIndGroup']['OpenSummaryAttributesTotals']['NumOpenAccts'];
                            }
                            ?>
                            <td colspan="2" style="width: 50%;">Open
                                <?php //echo ngettext('Account', 'Accounts', $openAccVal).' - '. $openAccVal;
                                echo "Accounts"; ?>
                            </td>

                            <?php
                            $closeAccVal = 0;
                            if(!empty($response_folder['ReportAttributes']['ClosedNonFiByIndGroup']['ClosedSummaryAttributesTotals']['NumCurrentAccts']) && !empty($response_folder['ReportAttributes']['ClosedNonFiByIndGroup']['ClosedSummaryAttributesTotals']['NumDelinquentAccts']))
                            {
                                $closeAccVal =  $response_folder['ReportAttributes']['ClosedNonFiByIndGroup']['ClosedSummaryAttributesTotals']['NumCurrentAccts']+$response_folder['ReportAttributes']['ClosedNonFiByIndGroup']['ClosedSummaryAttributesTotals']['NumDelinquentAccts'];
                            }
                            ?>

                            <td colspan="3" style="width: 50%;">Closed
                                <?php //echo ngettext('Account', 'Accounts', $closeAccVal).' - '. $closeAccVal;
                                echo "Accounts"; ?>
                            </td>
                        </tr>
                        <tr>
                            <td>Current</td>
                            <td>Delinquency</td>
                            <td>Current</td>
                            <td>Delinquency</td>
                            <td>Charge-Off</td>
                        </tr>
                        <tr>
                            <td><?php if(!empty($response_folder['ReportAttributes']['OpenNonFiByIndGroup']['OpenSummaryAttributesTotals']['NumOpenAccts'])){
                                    echo $response_folder['ReportAttributes']['OpenNonFiByIndGroup']['OpenSummaryAttributesTotals']['NumOpenAccts']; }else{ echo "0"; } ?></td>
                            <td>0</td>
                            <td><?php
                                if(!empty($response_folder['ReportAttributes']['ClosedNonFiByIndGroup']['ClosedSummaryAttributesTotals']['NumCurrentAccts'])){
                                    echo $response_folder['ReportAttributes']['ClosedNonFiByIndGroup']['ClosedSummaryAttributesTotals']['NumCurrentAccts']; }else{ echo "0"; } ?></td>
                            <td><?php if(!empty($response_folder['ReportAttributes']['ClosedNonFiByIndGroup']['ClosedSummaryAttributesTotals']['NumDelinquentAccts'])){
                                    echo $response_folder['ReportAttributes']['ClosedNonFiByIndGroup']['ClosedSummaryAttributesTotals']['NumDelinquentAccts'];
                                }else{ echo "0"; } ?></td>
                            <td><?php if(!empty($response_folder['ReportAttributes']['ClosedNonFiByIndGroup']['ClosedSummaryAttributesTotals']['NumChargeOffAccts'])){ echo $response_folder['ReportAttributes']['ClosedNonFiByIndGroup']['ClosedSummaryAttributesTotals']['NumChargeOffAccts']; }else{ echo "0"; } ?></td>
                        </tr>
                    </table>
                </td>
                <td valign="top" style="width:20%;">&nbsp;</td>
            </tr>
        </table>
    </td>
</tr>

<tr>
    <td colspan="3">
        <!-- HR Line-->
        <div class="row">
            <div class="col-md-12"><div style="page-break-after: always"></div></div>
        </div>
    </td>
</tr>
<tr>
    <td colspan="3">
        <table valign="top" width="100%">
            <tr>
                <td valign="top" style="width:100%;" class="totalaccount">
                    <!-- check Condition For Non-Financial Trade-Groups Open Account data -->
                    <?php
                    //if(!empty($response_folder['ReportAttributes']['OpenNonFiByIndGroup']['OpenSummaryAttributes']) && !empty($response['EfxTransmit']['CommercialCreditReport'][0]['Folder']['TradeInfo']))
                    {
                    ?>
                    <table id="openacdetails">
                        <tr>
                            <th colspan="7">Business Entity - Open Account Details</th>
                        </tr>

                                <?php
                                //$singleHiCreditExtOrBalOwed = array();
                                //$singleHighestTotalPastDue = array();
                                //sort array for Group of values.
                                $arrNonFinAccPaymentHistryParams = General::getGroupedArray($arrNonFinAccPaymentHistryParams, array('IndustryGroup'));
                                //plotting MONTH GRAPH at here.
                                $data  			 = "";
                                $year   		 =  "";
                                $month  		 =  "";
                                $flag_heading 	 =false;


                                $counter = 1;
                                foreach($arrNonFinAccPaymentHistryParams as $key => $payHis_val_outer){

                                if(!empty($response_folder['ReportAttributes']['OpenNonFiByIndGroup']['OpenSummaryAttributes']))
                                {

                                echo  '<table id="openacdetails" >';
                                // style="page-break-before: always;"

                                if($flag_heading==false){ ?>
                                <tr style="page-break-after: always;">
                                    <td style="background-color:#f2c50c; font-weight: 600; ">Industry</td>
                                    <td style="background-color:#f2c50c; font-weight: 600; ">No of  Accounts</td>
                                    <td style="background-color:#f2c50c; font-weight: 600; ">Account Status With Slow %</td>
                                    <td style="background-color:#f2c50c; font-weight: 600; ">Highest Balance Amount($)</td>
                                    <td style="background-color:#f2c50c; font-weight: 600; ">Highest Past Due Amount($) </td>
                                </tr>
                                <?php
                                $flag_heading=false;
                                }


                                $percent_slow = "";
                                foreach($response_folder['ReportAttributes']['OpenNonFiByIndGroup']['OpenSummaryAttributes'] as $key_inner => $grp_dtl){

                                if($key == $grp_dtl['IndustryGroup']){ ?>
                                <tr>
                                    <td><?php echo $grp_dtl['IndustryGroup']?></td>
                                    <td><?php echo $grp_dtl['NumOpenAccts']?> </td>
                                    <td><?php

                                        $percent_slow = General::getPercentSlowValue($grp_dtl['SingleMostSevereStatus']);

                                        if($percent_slow!=""){
                                            echo $grp_dtl[$percent_slow]. '%  ';
                                        }
                                        echo $grp_dtl['SingleMostSevereStatus'];
                                        ?></td>
                                    <td><?php echo $grp_dtl['SumOfBalances']['value']>0 ? "$" .number_format($grp_dtl['SumOfBalances']['value']) : '-';?></td>
                                    <td><?php echo $grp_dtl['SumOfPastDue']['value']>0 ? "$" .number_format($grp_dtl['SumOfPastDue']['value']) : '-';?>
                                    </td>
                                </tr>
                            <?php
                            }

                            }
                            echo '</table>';
                            }


                            //$counter = 1;
                            foreach($payHis_val_outer as $key =>$payHis_val)
                            {
                            $data   = $payHis_val['PaymentHistoryProfile'];
                            $year   = date('Y', strtotime($payHis_val['ReportedDate']));
                            $month  = date('m', strtotime($payHis_val['ReportedDate']));
                            //validate correct year when month i dec (12)
                            $formatted = implode(',',str_split($data));
                            $array = explode(",",$formatted);

                            if($counter%3==0){
                                echo '<table id="paymenthistory" style="page-break-after: always;">';
                            }else{
                                echo '<table id="paymenthistory" >';
                            }
                            ?>
                            <p style="height:40px;"> </p>
                            <!--<table id="paymenthistory" style="page-break-after: always;">-->
                                <!--<table id="paymenthistory">-->
                                <tr>
                                    <td colspan="13" style="background-color:#f2c50c; font-weight: 600; text-align: center; ">Ref. Account No :

                                        <?php echo $payHis_val['AccountReferenceNo'] . '<br>';
                                        //echo $counter."=CNT-KEY=".$key;
                                        ?>
                                    </td>
                                </tr>
                                <tr>
                                    <td> Year </td>
                                    <td> Dec </td>
                                    <td> Nov </td>
                                    <td> Oct </td>
                                    <td> Sep </td>
                                    <td> Aug </td>
                                    <td> Jul </td>
                                    <td> Jun </td>
                                    <td> May </td>
                                    <td> Apr </td>
                                    <td> Mar </td>
                                    <td> Feb </td>
                                    <td> Jan </td>
                                </tr>

                                <tr>
                                    <?php
                                    $k = 0;
                                    $i = 0;
                                    if($month == 01)
                                    {
                                        $year = $year - 1;

                                        echo "<td>". $year ."</td>";
                                        foreach($array as $val)
                                        {
                                            $i = $i + 1;

                                            echo "<td><div class=".General::getPayHisClass($val)."-roundbg>".General::getPayHisText($val)."</div></td>";
                                            if($i == 12 || $i == 24)
                                            {
                                                $year = $year - 1;
                                                echo "</tr> <tr> <td>". $year ."</td>";
                                            }
                                            else  if($i == 36 || $i == 48)
                                            {
                                                $year = $year - 1;
                                                echo "</tr> <tr> <td>". $year ."</td>";
                                            }
                                        }
                                    }
                                    else
                                    {

                                        echo "<td>". $year ."</td>";
                                        $etds = 0;
                                        for($j = 12; $j>= 0; $j--)
                                        {
                                            $i = $i + 1;
                                            if($k == 0)
                                            {

                                                if($j < $month)
                                                {
                                                    foreach($array as $val)
                                                    {
                                                        $i = $i + 1;

                                                        echo "<td><div class=".General::getPayHisClass($val)."-roundbg>".General::getPayHisText($val)."</div></td>";

                                                        // $j = $j + 1;
                                                        if($i == 13 || $i == 25)
                                                        {
                                                            $year = $year - 1;
                                                            echo "</tr> <tr> <td>". $year ."</td>";
                                                        }
                                                        else  if($i == 37 || $i == 49)
                                                        {
                                                            $year = $year - 1;
                                                            echo "</tr> <tr> <td>". $year ."</td>";
                                                        }
                                                        else if($i == 61)
                                                        {
                                                            $year = $year - 1;
                                                            echo "</tr> <tr> <td>". $year ."</td>";
                                                        }
                                                    }
                                                    $k = 1;

                                                    if($etds != 12 )
                                                    {
                                                         for($l = 12-$etds; $l>= 1; $l--)
                                                         {
                                                            echo "<td> </td>";
                                                         }
                                                    }

                                                }
                                                else
                                                {
                                                    echo "<td>  </td>";
                                                    $etds++;
                                                }
                                            }

                                        }
                                    }
                                    ?>

                                </tr>
                    </table>
                    <br/><br/>
                    <?php
                    //End of Code plotting for PaymentHistory.

                    //}
                    $counter++;
                    }

                    //last foreach counter
                    //$counter++;
                    }
                    ?>

                    </div>
                    </div>
        </table>
        <?php
        }
        ?>
        </div>
        <!-- END ['CODE -PICKED'] -->
    </td>
</tr>
</table>
</td>
</tr>

<!-- COLORED BLOCKs Comes Here -->

<tr>
    <td colspan="3">
        <!-- Business Account Closed Details-->
        <table valign="top" width="100%">
            <tr>
                <td valign="top" style="width:100%;" class="openacdetails">
                    <?php
                    if(!empty($response_folder['ReportAttributes']['ClosedNonFiByIndGroup']['ClosedSummaryAttributes']) && !empty($response['EfxTransmit']['CommercialCreditReport'][0]['Folder']['TradeInfo'])){ ?>
                    <table id="openacdetails">
                        <tr>
                            <th colspan="7">Business Entity - Closed Account Details</th>
                        </tr>

                        <!--  CODE WILL COME  IN THIS AREA  For CLOSED ACC DETAILS 						    -->
                                <?php
                                //$singleHiCreditExtOrBalOwed = array();
                                //$singleHighestTotalPastDue = array();
                                //sort array for Group of values.
                                $arrNonFinClosedAccPaymentHistryParams = General::getGroupedArray($arrNonFinClosedAccPaymentHistryParams, array('IndustryGroup'));
                                //plotting MONTH GRAPH at here.
                                $data  			 = "";
                                $year   		 =  "";
                                $month  		 =  "";
                                $flag_heading 	 =false;


                                foreach($arrNonFinClosedAccPaymentHistryParams as $key => $ClosedpayHis_val_outer){

                                if(!empty($response_folder['ReportAttributes']['ClosedNonFiByIndGroup']['ClosedSummaryAttributes'])){

                                echo '<table id="openacdetails" style="width:100%;">';

                                if($flag_heading==false){ ?>
                                <tr>
                                    <td style="background-color:#f2c50c; font-weight: 600; ">Industry</td>
                                    <td style="background-color:#f2c50c; font-weight: 600; ">No of  Accounts</td>
                                    <td style="background-color:#f2c50c; font-weight: 600; ">Closed Date</td>
                                    <td style="background-color:#f2c50c; font-weight: 600; ">Highest Balance Amount($)</td>
                                </tr>
                                <?php

                                $flag_heading=false;
                                }
                                ?>
                                <tr>
                                    <?php
                                    $percent_slow = "";

                                    foreach($response_folder['ReportAttributes']['ClosedNonFiByIndGroup']['ClosedSummaryAttributes'] as $key_inner => $grp_dtl){

                                    if($key == $grp_dtl['IndustryGroup']){
                                    ?>
                                    <td><?php echo $grp_dtl['IndustryGroup']?></td>
                                    <td><?php echo $grp_dtl['NumCurrentAccts']?> </td>
                                    <td>
                                        <?php
                                        echo !empty($grp_dtl['MostRecentDateCurrent']) ? $grp_dtl['MostRecentDateCurrent'] : ' - ';
                                        ?></td>
                                    <td><?php echo $grp_dtl['SingleHiCreditExtOrBalOwed']>0 ? "$" .number_format($grp_dtl['SingleHiCreditExtOrBalOwed']) : '-';?>
                                    </td>
                                </tr>
                                <?php
                                }
                                }
                                echo '</table>';
                                }

                                /* Display all Accounts in Given Group Name, from below loop */
                               // dd($ClosedpayHis_val_outer);
                               $counter = 1;
                                foreach($ClosedpayHis_val_outer as $key =>$payHis_val)
                                {
                                    $data   = $payHis_val['PaymentHistoryProfile'];
                                    $year   = date('Y', strtotime($payHis_val['ReportedDate']));
                                    $month  = date('m', strtotime($payHis_val['ReportedDate']));
                                    //validate correct year when month i dec (12)
                                    $formatted = implode(',',str_split($data));
                                    $array = explode(",",$formatted);

                                    if($counter%3==0){
                                        echo '<table id="paymenthistory" style="page-break-after: always;">';
                                    }else{
                                        echo '<table id="paymenthistory" >';
                                    }
                                    ?>
                                   <p style="height:40px;"> </p>
                                    <!--<table id="paymenthistory" style="page-break-after: always;">-->
                                        <!--<table id="paymenthistory">-->
                                        <tr>
                                            <td colspan="13" style="background-color:#f2c50c; font-weight: 600; text-align: center; ">Ref. Account No :

                                                <?php echo $payHis_val['AccountReferenceNo'] . '<br>';
                                                //echo $counter."=CNT-KEY=".$key;
                                                ?>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td> </td>
                                            <td> Dec </td>
                                            <td> Nov </td>
                                            <td> Oct </td>
                                            <td> Sep </td>
                                            <td> Aug </td>
                                            <td> Jul </td>
                                            <td> Jun </td>
                                            <td> May </td>
                                            <td> Apr </td>
                                            <td> Mar </td>
                                            <td> Feb </td>
                                            <td> Jan </td>
                                        </tr>

                                        <tr>
                                            <?php
                                            $k = 0;
                                            $i = 0;
                                            if($month == 01)
                                            {
                                                $year = $year - 1;

                                                echo "<td>". $year ."</td>";
                                                foreach($array as $val)
                                                {
                                                    $i = $i + 1;

                                                    echo "<td><div class=".General::getPayHisClass($val)."-roundbg>".General::getPayHisText($val)."</div></td>";
                                                    if($i == 12 || $i == 24)
                                                    {
                                                        $year = $year - 1;
                                                        echo "</tr> <tr> <td>". $year ."</td>";
                                                    }
                                                    else  if($i == 36 || $i == 48)
                                                    {
                                                        $year = $year - 1;
                                                        echo "</tr> <tr> <td>". $year ."</td>";
                                                    }
                                                }
                                            }
                                            else
                                            {

                                                echo "<td>". $year ."</td>";
                                                $etds = 0;
                                                for($j = 12; $j>= 0; $j--)
                                                {
                                                    $i = $i + 1;
                                                    if($k == 0)
                                                    {

                                                        if($j < $month)
                                                        {
                                                            foreach($array as $val)
                                                            {
                                                                $i = $i + 1;

                                                                echo "<td><div class=".General::getPayHisClass($val)."-roundbg>".General::getPayHisText($val)."</div></td>";

                                                                // $j = $j + 1;
                                                                if($i == 13 || $i == 25)
                                                                {
                                                                    $year = $year - 1;
                                                                    echo "</tr> <tr> <td>". $year ."</td>";
                                                                }
                                                                else  if($i == 37 || $i == 49)
                                                                {
                                                                    $year = $year - 1;
                                                                    echo "</tr> <tr> <td>". $year ."</td>";
                                                                }
                                                                else if($i == 61)
                                                                {
                                                                    $year = $year - 1;
                                                                    echo "</tr> <tr> <td>". $year ."</td>";
                                                                }
                                                            }
                                                            $k = 1;

                                                            if($etds != 12 )
                                                            {
                                                                 for($l = 12-$etds; $l>= 1; $l--)
                                                                 {
                                                                    echo "<td> </td>";
                                                                 }
                                                            }

                                                        }
                                                        else
                                                        {
                                                            echo "<td>  </td>";
                                                            $etds++;
                                                        }
                                                    }

                                                }
                                            }
                                            ?>

                                        </tr>
                            </table>
                            <br/><br/>
                            <?php
                            //End of Code plotting for PaymentHistory.

                            //}
                            $counter++;
                            }  // CLOSED ACCOUNTS

                               // dd($ClosedpayHis_val_outer);

                            }

                                ?>
                                <table width="100%" class="col-md-12">
                                    <tr>
                                        <td valign="top" class="tab-legends">
                                            <table width="100%">
                                                <tr>
                                                    <td><div class="tab-blue"></div>Not-exist</td>
                                                    <td><div class="tab-lblue"></div>Closed</td>
                                                    <td><div class="tab-green"></div>On-time</td>
                                                    <td><div class="tab-red"></div>Slow</td>
                                                    <td><div class="tab-orange"></div>Non-accrual account</td>
                                                    <td><div class="tab-bri"></div>Repossession</td>
                                                    <td><div class="tab-pur"></div>Collection</td>
                                                    <td><div class="tab-black"></div>Charge- Off</td>
                                                </tr>
                                            </table>
                                        </td>
                                    </tr>
                                </table>
                            </td>
                        </tr>
                        </div>
                        </div>

                    </table>
                <?php
                }
                ?>
                <!--     CODE ENDS AT HERE    For Closed acc details.     -->
                </td>
            </tr>
			</td>
            </tr>

            <tr>
                <td colspan="3">&nbsp;</td>
            </tr>
            </table>
</body>
@if(isset($response) && !empty($response))

@endif
