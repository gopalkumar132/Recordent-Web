<style type="text/css">
.wapper{width: 100%; overflow: hidden;}
   .title_imporve.progress_bar_green{color:#82e360!important; background: none !important;}
.title_imporve.progress_bar_yellow{color:#f5d13d!important;  background: none !important;}
.title_imporve.progress_bar_orange{color:#ffb36c!important;  background: none !important;}
.title_imporve.progress_bar_red{color:#ff6c6c!important;  background: none !important;}
.progress_bar_green{background:#82e360!important}
.progress_bar_yellow{background:#f5d13d!important}
.progress_bar_orange{background:#ffb36c!important}
.progress_bar_red{background:#ff6c6c!important}
.right-block{float:right}
.pdf_screens{font-family:Arial,Helvetica,sans-serif!important;width:1260px;margin:0 auto 0 auto}
.pdf_block{border:solid 1px #e9e9e9;padding:15px 20px;background:#fff;box-shadow:3px 3px 15px #eee;-moz-box-shadow:3px 3px 15px #eee;-webkit-box-shadow:3px 3px 15px #eee;-o-box-shadow:3px 3px 15px #eee;margin-bottom:30px}
.item{border:solid 1px #e9e9e9;padding:15px 15px;background:#fff;box-shadow:3px 3px 15px #eee;-moz-box-shadow:3px 3px 15px #eee;-webkit-box-shadow:3px 3px 15px #eee;-o-box-shadow:3px 3px 15px #eee;margin-bottom:30px;}
.item p,.item span{font-size:14px;line-height:22px}
.pdf_progress{height:350px;text-align:center}
.left_top{float:left;width:50%;text-align:left}
.right_top{float:right;text-align:right;width:50%}
.clear{clear:both;width:100%;height:1px;display:block}h1,h2,h3,h4,h5,h6,li,p{padding:0;margin:0}
.rc_mid{padding:10px 0}
.rc_mid h2{font-weight:700!important;text-align:center;font-size:100px;line-height:102px;color:#0d1332}
.last-update,.rc_age .rc_block p.last-update{font-size:16px;color:#000;font-weight:600;text-align:left}
.right_top h5{font-size:28px;line-height:30px;font-weight:400!important;color:#202f7d}
.pdf_progress .right_top{text-align:right}
.right_top p{color:#000;font-size:16px;line-height:20px}
.rc_progress{width:900px;position:relative;margin:10px auto 70px auto;height:15px;border-radius:10px;background:#eee}
.right_top h5{font-size:28px;line-height:30px;font-weight:400!important;color:#202f7d}
.pdf_progress .right_top{text-align:right}
.right_top p{color:#000;font-size:16px;line-height:20px}
.rc_progress{width:900px;position:relative;margin:40px auto 90px auto;height:15px;background:#eee}
.rc_progress .progress-bar-danger{background:#ff6c6c!important;height:15px}
.rc_progress .progress-bar span.lp,.rc_progress .progress-bar span.rp{font-size:16px;color:#000;font-weight:400;height:15px;width:30px;float:left;margin-top:40px}
.rc_progress .progress-bar span.rp{float:right}
.rc_progress .progress-bar-warning{background:#ffb36c!important}
.rc_progress .progress-bar{position:relative;height:15px;float:left}
.rc_progress .progress-bar-info{background:#f5d13d!important}
.rc_progress .progress-bar-success{background:#82e360!important}
.rc_progress .progress-bar-active{position:absolute!important;background:#82e360;width:12px;height:50px;top:-18px;border:solid 1px #fff;z-index:99}
.rc_progress .progress-bar-danger::before,.rc_progress .progress-bar-info::before,.rc_progress .progress-bar-warning::before{content:"";width:5px;height:100%;position:absolute;right:0;top:0;background:#fff}
.rc-pdf-block{width:358px;float:left;height:150px}
.marginl{margin-left:30px}
.sub{font-size:20px;line-height:24px;color:#0d1332;font-weight:400;padding:0 0 10px 0;margin:0}
.rc_bottom .left_bottom p{font-size:18px;line-height:24px;color:#575c71;font-weight:600!important;margin-bottom:0}
.rc_bottom .left_bottom p{font-size:16px}
.rc_bottom i{display:inline-block;font-style:normal;width:80px;font-weight:400!important}
.rc_bottom .left_bottom p span{color:#202f7d}
.pdf-title{font-size:50px;line-height:56px;padding:0;font-weight:700;margin:0 0 30px 0;color:#202f7d}
.sub-title{color:#000;font-size:26px;line-height:28px;font-weight:600;padding-bottom:20px;margin:0}
.sub_mainBlock h2{color:#000120;font-size:30px;line-height:34px;font-weight:600;padding-bottom:20px;margin:0}

.sub_mainBlock .block{width:610px;float:left;border-left:solid 1px #202f7d;padding:0 0 0 30px;margin:0 0 10px 0}
.sub_mainBlock .block ul{list-style:none;margin:0;padding:0}
.sub_mainBlock .block ul li{font-size:16px;line-height:22px;padding:0;margin:0 0 3px 0;color:#000;font-weight:400}
.sub_mainBlock .block ul li span{color:#202f7d;font-weight:700;display:inline-block;vertical-align:top; font-size: 18px; max-width: 50%;}
.sub_mainBlock.ntb .block ul li span{font-size: 13px;}
.sub_mainBlock .block ul li span:first-child{width:40%;color:#000;font-weight:400}




.sub_mainBlock .block01{border-left:solid 1px #202f7d;padding:0 0 0 30px;margin:0 0 10px 0}
.sub_mainBlock .block01 ul{list-style:none;margin:0;padding:0}
.sub_mainBlock .block01 ul li{font-size:16px;line-height:22px;padding:0;margin:0 0 3px 0;color:#000;font-weight:400}
.sub_mainBlock .block01 ul li span{color:#202f7d;font-weight:700;display:inline-block;vertical-align:top; font-size: 18px; max-width: 50%;}
.sub_mainBlock.ntb .block01 ul li span{font-size: 13px;}
.sub_mainBlock .block01 ul li span:first-child{width:40%;color:#000;font-weight:400}







.sub-head{font-size:20px;line-height:24px;color:#0d1332;font-weight:400;margin-bottom:20px}
.left-block{float:left}
.grid_table{display:block;text-align:center; }
.payment_history .item h4{float:left;text-align:left;line-height:40px}
.payment_history .item h4 span{display:block;font-size:20px;font-weight:400;color:#000}
.payment_history .item p{float:right;font-size:22px;line-height:24px;color:#000;font-weight:600;text-align:right;line-height:40px}
.payment_history .item p span{color:#4cb826}
.payment_history .item p em{font-style:normal;display:block;font-weight:400}
.grid_table .grid-block{margin-top:15px;}
.red-icon{width:15px;height:15px;background:#2dac00;border-radius:7px}
.green-icon{width:15px;height:15px;background:#f5821f;border-radius:7px}
.orange-icon{width:15px;height:15px;background:#ef4023;border-radius:7px}
.anc_active{width:15px;height:15px;border-radius:7px}
.oneitme{background:#2dac00; width:15px;height:15px;border-radius:7px}
.miditme{background:#f5821f; width:15px;height:15px;border-radius:7px}
.latetime{background:#ef4023; width:15px;height:15px;border-radius:7px}
.grid_table table td,.grid_table table th{text-align:center;padding:1px 3px;font-family:Open Sans,sans-serif!important;font-weight:400!important;position:relative;color:#000!important;font-size:15px;line-height:18px;background:#fff!important}
.anc_active{display:inline-block;position:relative;left:15px;top:3px;line-height:30px; margin: 3px 0 0 29px;}
table{border-collapse:collapse;  }
.enquires_section{page-break-inside: avoid;}
/*.innner01{height:165px; background: red;}*/





.height_block{height:500px; overflow: hidden; }
.sub_mainBlock.recordent_sub_mainBlock .block ul li{font-size:18px;line-height:26px;}
</style>
<div class="wapper">
<div class="main-logo" style="margin-top:20px;" ><img width="230px" height="auto" style="width:230px" height="auto" src="https://www.recordent.com/storage/settings/October2020/AcTr8eo13eZ5h2voebv1.jpg"/></div>

@if(isset($response) && !empty($response))@php
$idnumber = isset($response['CCRResponse']['CIRReportDataLst'][0]['CIRReportData']['IDAndContactInfo']['IdentityInfo']['PANId']) ? $response['CCRResponse']['CIRReportDataLst'][0]['CIRReportData']['IDAndContactInfo']['IdentityInfo']['PANId'][0] : 0;
$ndnumber = isset($response['CCRResponse']['CIRReportDataLst'][0]['CIRReportData']['IDAndContactInfo']['IdentityInfo']['NationalIDCard']) ? $response['CCRResponse']['CIRReportDataLst'][0]['CIRReportData']['IDAndContactInfo']['IdentityInfo']['NationalIDCard'][0] : 0;
@endphp
<div class="pdf_screens equifax-pff">

<div class="pdf_block pdf_progress" style="margin-top:60px;  margin-bottom:30px;  height:400px; ">
@if(isset($response) && !empty($response))
<div class="inner">
<div class="rc_top">
<div class="left_top">
<h4 style="text-transform: uppercase;">CURRENT SCORE OF
{{ isset($response['CCRResponse']['CIRReportDataLst'][0]['CIRReportData']['IDAndContactInfo']['PersonalInfo']['Name']['FullName']) ? $response['CCRResponse']['CIRReportDataLst'][0]['CIRReportData']['IDAndContactInfo']['PersonalInfo']['Name']['FullName'] : $response['CCRResponse']['CIRReportDataLst'][0]['CIRReportData']['IDAndContactInfo']['PersonalInfo']['Name']['FullName']}} is:</h4>
</div>
<div class="right_top" style="text-align:center; width:200px;">
<p style="color: #777;   font-size: 16px;    line-height: 20px;    font-weight: 600;">Powered by </P>        
<div class="ma_title eqfuifax_title">
<img style="width: 160px;    height: auto;  margin-top: 5px;" width="180px" height="auto" src="https://www.test.recordent.com/640px-Equifax_Logo.svg.png" alt="">
</div>
</div>
<div class="clear" style="clear:both; width:100%; height:1px; display:block;"></div>
</div>
<div class="rc_mid">
<h2>{{ $response['CCRResponse']['CIRReportDataLst'][0]['CIRReportData']['ScoreDetails'][0]['Value'] }} </h2>
<?php
$score = $response['CCRResponse']['CIRReportDataLst'][0]['CIRReportData']['ScoreDetails'][0]['Value'];
$scoreText = 'Needs improvement';
if ($score > 750) {
$scoreText = 'Excellent';
} else if ($score >= 700 && $score < 749) {
$scoreText = 'Good';
} else if ($score >= 650 && $score < 700) {
$scoreText = 'Fair';
} ?>
<h5 style="font-size:30px; color:#82e360; font-weight:bold">{{$scoreText}}</h5>
</div>
<div class="progress rc_progress">
<div id="progress-bar-active-score" class="progress-bar-active" role="progressbar" style="left:{{ $response['CCRResponse']['CIRReportDataLst'][0]['CIRReportData']['ScoreDetails'][0]['Value'] }}px;
"></div>
<div class="progress-bar progress-bar-danger" role="progressbar" style="width:650px">
<span class="lp">300</span> <span class="rp">650</span>
</div>
<div class="progress-bar progress-bar-warning" role="progressbar" style="width:50px">
<span class="rp">700</span>
</div>
<div class="progress-bar progress-bar-info" role="progressbar" style="width:50px">
<span class="rp">750</span>
</div>
<div class="progress-bar progress-bar-success" role="progressbar" style="width:150px">
<span class="rp">900</span>
</div>
</div>
<p class="last-update">Report Date: 22-28-2020</p>
</div>
@endif
</div>

<div class="sub_mainBlock ntb" style="border: none; margin-top:70px; margin-left:10px;">
<h2>Profile</h2>
<div class="block" style="width: 400px;">
<h4 class="sub">Personal &amp; Account information</h4>
<ul>
<li><span>Consumer's First Name:</span> <span>{{ isset($response['CCRResponse']['CIRReportDataLst'][0]['CIRReportData']['IDAndContactInfo']['PersonalInfo']['Name']['FirstName']) ? $response['CCRResponse']['CIRReportDataLst'][0]['CIRReportData']['IDAndContactInfo']['PersonalInfo']['Name']['FirstName'] : $response['CCRResponse']['CIRReportDataLst'][0]['CIRReportData']['IDAndContactInfo']['PersonalInfo']['Name']['FullName']  }} </span></li>
<li><span>Consumer's Last Name:</span> <span>
{{ isset($response['CCRResponse']['CIRReportDataLst'][0]['CIRReportData']['IDAndContactInfo']['PersonalInfo']['Name']['FirstName']) ? $response['CCRResponse']['CIRReportDataLst'][0]['CIRReportData']['IDAndContactInfo']['PersonalInfo']['Name']['LastName'] : $response['CCRResponse']['CIRReportDataLst'][0]['CIRReportData']['IDAndContactInfo']['PersonalInfo']['Name']['FullName']  }}
</span></li>
<li><span>DOB:</span> <span>
{{ isset($response['CCRResponse']['CIRReportDataLst'][0]['CIRReportData']['IDAndContactInfo']['PersonalInfo']['DateOfBirth']) ? General::getMaskedDOB(General::getFormatedDate($response['CCRResponse']['CIRReportDataLst'][0]['CIRReportData']['IDAndContactInfo']['PersonalInfo']['DateOfBirth'])) : ''}}
</span></li>
<li><span>Gender:</span> <span>
{{ isset($response['CCRResponse']['CIRReportDataLst'][0]['CIRReportData']['IDAndContactInfo']['PersonalInfo']['Gender']) ? $response['CCRResponse']['CIRReportDataLst'][0]['CIRReportData']['IDAndContactInfo']['PersonalInfo']['Gender'] : ''}}
</span></li>
@if(!empty($sallerys['sallery']))
<li><span>Sallary:</span> <span> {{$sallerys['sallery']}} </span></li>
@endif
</ul>
<div class="clear"></div>
</div>
<div class="block" style="width: 400px; ">
<h4 class="sub">ID &amp; Phone Number</h4>
<ul>

@if(isset($response['CCRResponse']['CIRReportDataLst'][0]['CIRReportData']['IDAndContactInfo']['IdentityInfo']['PANId']) && isset($response['CCRResponse']['CIRReportDataLst'][0]['CIRReportData']['IDAndContactInfo']['IdentityInfo']['PANId'][0]))
<li><span>PAN:</span> <span>{{General::getMaskedPAN($idnumber['IdNumber'])}} </span></li>
@endif

@if(isset($response['CCRResponse']['CIRReportDataLst'][0]['CIRReportData']['IDAndContactInfo']['IdentityInfo']['VOTERId']) && isset($response['CCRResponse']['CIRReportDataLst'][0]['CIRReportData']['IDAndContactInfo']['IdentityInfo']['VOTERId'][0]))
<li><span>Voter ID: </span> <span>
{{ General::getMaskedCharacters($response['CCRResponse']['CIRReportDataLst'][0]['CIRReportData']['IDAndContactInfo']['IdentityInfo']['VOTERId'][0]['IdNumber']) }}
</span>
</li>
@endif

@if(isset($response['CCRResponse']['CIRReportDataLst'][0]['CIRReportData']['IDAndContactInfo']['IdentityInfo']['Passport']) && isset($response['CCRResponse']['CIRReportDataLst'][0]['CIRReportData']['IDAndContactInfo']['IdentityInfo']['Passport'][0]))
<li><span>Passport ID:</span>
<span>{{ General::getMaskedPAN($response['CCRResponse']['CIRReportDataLst'][0]['CIRReportData']['IDAndContactInfo']['IdentityInfo']['Passport'][0]['IdNumber']) }}
</span>
</li>
@endif
@if(isset($response['CCRResponse']['CIRReportDataLst'][0]['CIRReportData']['IDAndContactInfo']['IdentityInfo']['NationalIDCard']) && isset($response['CCRResponse']['CIRReportDataLst'][0]['CIRReportData']['IDAndContactInfo']['IdentityInfo']['NationalIDCard'][0]))
<li><span>UID:</span> <span> ******* {{substr($ndnumber['IdNumber'], 6)}} </span> </li>
@endif

@if(isset($response['CCRResponse']['CIRReportDataLst'][0]['CIRReportData']['IDAndContactInfo']['IdentityInfo']['DriverLicence']) && isset($response['CCRResponse']['CIRReportDataLst'][0]['CIRReportData']['IDAndContactInfo']['IdentityInfo']['DriverLicence'][0]))
<li><span>Driver's License:</span><span>
{{ General::getMaskedCharacters($response['CCRResponse']['CIRReportDataLst'][0]['CIRReportData']['IDAndContactInfo']['IdentityInfo']['DriverLicence'][0]['IdNumber']) }}         
</span> </li>
@endif
@if(!empty($number['mobile']))
<li><span>Mobile Phone:</span><span>{{ $number['mobile'] }}</span> </li>
@endif
@if(!empty($number['home']))
<li><span>Home Phone:</span><span>{{General::getMaskedPhone($number['home'])}} </span></li>
@endif
@if(!empty($number['workphone']))
<li><span>Office Phone:</span><span>{{ General::getMaskedPhone($number['workphone']) }}</span> </li>
@endif
</ul>
<div class="clear"></div>
</div>
<div class="block" style="width: 400px; ">
<h4 class="sub">Contact Details</h4>
<ul>
<li class="addres-rc"><span>Address: </span> <span class="address_span">
**** **** **** </br> **** **** **** {{substr($AddressInfo[0]['Address'], 300)}}
</span></li>
<li><span>State:</span> <span> {{isset($AddressInfo[0]) ? $AddressInfo[0]['State'] : '-'}} </span></li>
<li><span>Pin Code:</span> <span> {{isset($AddressInfo[0]) ? $AddressInfo[0]['Postal'] : '-'}} </span></li>
<li><span>Reported Date:</span> <span> {{isset($AddressInfo[0]) ? General::getFormatedDate($AddressInfo[0]['ReportedDate']) : '-'}} </span></li>
</ul>
<div class="clear"></div>
</div>
<div class="clear"></div>
</div>

    <div class="pdf-row" style="margin:60px 0 50px 0 !important;">
        <div class="pdf_block bottom_block rc-pdf-block ">
            <div class="inner">
                <div class="rc_top">
                    <div class="left_top" style="width:100%; ">
                        <h4 class="sub">Age</h4>
                        <p>Age of credit accounts</p>
                        <p style="margin-top:65px; ">Since 1st account: <span style="color: #202f7d; font-weight: bold;"><?php
                                                                                                                            $years = floor($diff / (365 * 60 * 60 * 24));
                                                                                                                            $months = floor(($diff - $years * 365 * 60 * 60 * 24) / (30 * 60 * 60 * 24));
                                                                                                                            ?>
                                {{$years}} years {{$months}} months</span>
                        </p>
                    </div>
                    <div class="clear" style="clear:both; width:100%; height:1px; display:block;"></div>
                </div>

            </div>
        </div>
        <div class="pdf_block bottom_block rc-pdf-block " style="margin-left:30px; ">
            <div class="inner">
                <div class="rc_top">
                    <div class="left_top" style="width:100%; ">
                        <h4 class="sub">Payment history</h4>
                        <p>On-time & delayed payments</p>
                        <p style="margin-top:65px; ">Payments on time: <span style="color: #202f7d; font-weight: bold;">{{$totalSuccessPayment}}/{{$totalPayments}}</span></p>
                    </div>
                    <div class="clear" style="clear:both; width:100%; height:1px; display:block;"></div>
                </div>

            </div>
        </div>
        <div class="clear" style="clear:both; width:100%; height:1px; display:block;"></div>

        <div class="pdf_block bottom_block rc-pdf-block " style="">
            @php
            $open = 0;
            $close = 0;
            @endphp
            @foreach ($response['CCRResponse']['CIRReportDataLst'][0]['CIRReportData']['RetailAccountDetails'] as $key => $value)
            @if(isset($value['DateClosed']))
            @php($close++)
            @else
            @php($open++)
            @endif
            @endforeach
            <div class="inner">
                <div class="rc_top">
                    <div class="left_top" style="width:100%; ">
                        <h4 class="sub">Accounts</h4>
                        <p>Type & status of credit accounts</p>
                        <div style="margin-top:65px; ">
                            <p style="float:left; width:40% ">Active: <span style="color: #202f7d; font-weight: bold;">
                                    {{ $open }}</span>
                            </p>

                            <p style=" float:right; width:50% ">Closed: <span style="color: #202f7d; font-weight: bold;">{{ $close }}</span></p>

                            <div class="clear" style="clear:both; width:100%; height:1px; display:block;"></div>
                        </div>

                    </div>
                    <div class="clear" style="clear:both; width:100%; height:1px; display:block;"></div>
                </div>

            </div>
        </div>
        <div class="pdf_block bottom_block rc-pdf-block " style="margin-left:30px;">
            <div class="inner">
                <div class="rc_top">
                    <div class="left_top" style="width:100%; ">
                        <h4 class="sub">Limits</h4>
                        <p>Remaining limit on open credit cards</p>
                        <p style="margin-top:65px; ">Credit available: <span style="color: #202f7d; font-weight: bold;">
                                <span>{{$limit}}%</span></p>
                    </div>
                    <div class="clear" style="clear:both; width:100%; height:1px; display:block;"></div>
                </div>

            </div>
        </div>
        <div class="pdf_block bottom_block rc-pdf-block " style="margin-left:30px;">
            <div class="inner">
                <div class="rc_top">
                    <div class="left_top" style="width:100%; ">
                        <h4 class="sub">Enquiries</h4>
                        <p>Loan / Credit Card applications</p>
                        <p style="margin-top:65px; ">Enquiries in last 30 days: <span style="color: #202f7d; font-weight: bold;">
                                {{ isset($response['CCRResponse']['CIRReportDataLst'][0]['CIRReportData']['EnquirySummary']) && isset($response['CCRResponse']['CIRReportDataLst'][0]['CIRReportData']['EnquirySummary']['Past30Days']) ? $response['CCRResponse']['CIRReportDataLst'][0]['CIRReportData']['EnquirySummary']['Past30Days'] : 0 }}
                            </span>
                        </p>
                    </div>
                    <div class="clear" style="clear:both; width:100%; height:1px; display:block;"></div>
                </div>

            </div>
        </div>
        <div class="clear" style="clear:both; width:100%; height:1px; display:block;"></div>
    </div>

    <?php
    $paymentStatusOnTimeArray = ['000', '*', 'STD', 'NEW', 'CLSD', 'OPEN', 'RES'];
    $paymentStatusLateArray = ['01+', '30+', '60+'];
    $paymentStatusVeryLateTimeArray = ['180+', '360+', '540+', '720+', 'SET', 'WOF', 'POWS', 'INV', 'DEV', 'RNC'];
    ?>

<h1 class="pdf-title eq-title" style="margin-top:0px; margin-bottom:30px;  ">Equifax</h1>
<div class="sub_mainBlock ">
<h2 style="">Accounts</h2>



<?php $existACC = false; ?>
@foreach($response['CCRResponse']['CIRReportDataLst'][0]['CIRReportData']['RetailAccountDetails'] as $key => $value)

<div class="height_block">

<?php
$tempYears = array();
$onTimePaymentCount = 0;
foreach ($value['History48Months'] as $k => $v) {
$date = DateTime::createFromFormat("m-y", $v['key']);

$str = '';
if (in_array($v['PaymentStatus'], $paymentStatusOnTimeArray)) {
$str = '<a class="anc_active oneitme" href="javascript:void(0)">';
$onTimePaymentCount++;
} else if (in_array($v['PaymentStatus'], $paymentStatusLateArray)) {
$str = '<a class="anc_active miditme" href="javascript:void(0)">';
} else if (in_array($v['PaymentStatus'], $paymentStatusVeryLateTimeArray)) {
$str = '<a class="anc_active latetime" href="javascript:void(0)">';
}

if (isset($tempYears[$date->format("Y")])) {
$tempYears[$date->format("Y")][$date->format("M")] = $str;
} else {
$tempYears[$date->format("Y")] = array();
$tempYears[$date->format("Y")][$date->format("M")] = $str;
}
}
$history_percentage = number_format(($onTimePaymentCount * 100) / count($value['History48Months']), 2);
$ownershipType = array_key_exists('OwnershipType',$value) ? $value['OwnershipType'] : 'NA';
?>
@if($value['Open'] == 'Yes')
<div class="innner" style="margin-top:30px">
<div class="block" style="height: 80px; margin-bottom:20px">
<ul>
<li><span>Lender name:</span> <span style="max-width: 50%;">**** **** {{substr($value['Institution'], 140)}}</span></li>
<li><span>A/C number:</span> <span style="    max-width: 50%;  display:inline-block !important; white-space: normal; word-break:break-all;  ">**** **** {{substr($value['AccountNumber'], -4)}}</span></li>
<li><span>Ownership type:</span> <span>{{$ownershipType}}</span></li>
</ul>
<div class="clear" style="clear:both; width:100%; height:1px; display:block;"></div>
</div>
<div class="block" style="height: 80px; margin-bottom:20px">
<ul>
<li><span>Account type:</span> <span>{{$value['AccountType']}}</span></li>
<li><span>Account status:</span> <span>{{$value['AccountStatus']}}</span></li>
<li><span>Open:</span> <span>{{$value['Open'] }}</span></li>
</ul>
<div class="clear" style="clear:both; width:100%; height:1px; display:block;"></div>
</div>
<div class="clear" style="clear:both; width:100%; height:1px; display:block;"></div>
<div class="block" style="height: 80px; margin-bottom:20px">
<ul>
<li><span>Date opened:</span> <span>{{isset($value['DateOpened']) ? General::getFormatedDate($value['DateOpened']) : '-'}}</span></li>
<li><span>Date closed:</span> <span>{{isset($value['DateClosed']) ? General::getFormatedDate($value['DateClosed']) : '-'}}</span></li>
<li><span>Last updated:</span> <span>{{isset($value['DateReported']) ? General::getFormatedDate($value['DateReported']) : '-'}}</span></li>
</ul>
<div class="clear" style="clear:both; width:100%; height:1px; display:block;"></div>
</div>
<div class="block" style="height: 80px; margin-bottom:20px">
<ul>
<li><span>Loan amount:</span> <span> {{isset($value['SanctionAmount']) ? 'Rs '.number_format($value['SanctionAmount']) : '-'}}</span></li>
<li><span>Current balance:</span> <span>{{isset($value['Balance']) ? 'Rs '.number_format($value['Balance']) : '-'}}</span></li>
<li><span>Past due amount:</span> <span>{{isset($value['PastDueAmount']) ? 'Rs '.number_format($value['PastDueAmount']) : '-'}}</span></li>
</ul>
<div class="clear" style="clear:both; width:100%; height:1px; display:block;"></div>
</div>
<div class="clear" style="clear:both; width:100%; height:1px; display:block;"></div>
</div>
@endif
@if($value['Open'] != 'Yes')
<div class="innner" style="margin-top:30px">
<div class="block" style="height: 80px; margin-bottom:20px">
<ul>
<li><span>Lender name:</span> <span style="max-width: 50%;">**** **** {{substr($value['Institution'], 140)}}</span></li>
<li><span>A/C number:</span> <span style="    max-width: 50%;  display:inline-block !important; white-space: normal; word-break:break-all;  ">**** **** {{substr($value['AccountNumber'], -4)}}</span></li>
<li><span>Ownership type:</span> <span>{{$ownershipType}}</span></li>
</ul>
<div class="clear" style="clear:both; width:100%; height:1px; display:block;"></div>
</div>
<div class="block" style="height: 80px; margin-bottom:20px">
<ul>
<li><span>Account type:</span> <span>{{$value['AccountType']}}</span></li>
<li><span>Account status:</span> <span>{{$value['AccountStatus']}}</span></li>
<li><span>Open:</span> <span>{{$value['Open'] }}</span></li>
</ul>
<div class="clear" style="clear:both; width:100%; height:1px; display:block;"></div>
</div>
<div class="clear" style="clear:both; width:100%; height:1px; display:block;"></div>
<div class="block" style="height: 80px; margin-bottom:20px">
<ul>
<li><span>Date opened:</span> <span>{{isset($value['DateOpened']) ? General::getFormatedDate($value['DateOpened']) : '-'}}</span></li>
<li><span>Date closed:</span> <span>{{isset($value['DateClosed']) ? General::getFormatedDate($value['DateClosed']) : '-'}}</span></li>
<li><span>Last updated:</span> <span>{{isset($value['DateReported']) ? General::getFormatedDate($value['DateReported']) : '-'}}</span></li>
</ul>
<div class="clear" style="clear:both; width:100%; height:1px; display:block;"></div>
</div>
<div class="block" style="height: 80px; margin-bottom:20px">
<ul>
<li><span>Loan amount:</span> <span>Rs {{isset($value['SanctionAmount']) ? number_format($value['SanctionAmount']) : '-'}}</span></li>
<li><span>Current balance:</span> <span>Rs {{isset($value['Balance']) ? number_format($value['Balance']) : '-'}}</span></li>
<li><span>Past due amount:</span> <span>Rs {{isset($value['PastDueAmount']) ? number_format($value['PastDueAmount']) : '-'}}</span></li>
</ul>
<div class="clear" style="clear:both; width:100%; height:1px; display:block;"></div>
</div>
<div class="clear" style="clear:both; width:100%; height:1px; display:block;"></div>
</div>
@endif
<div style="margin-bottom:0px;" class="grid_table mb30">
<p style="margin-bottom:0; font-size: 20px; color: #1c223f;">Payment history of this account  
<em style="font-style:normal; text-align:right; margin-bottom: 15px;">{{$onTimePaymentCount}} / {{count($value['History48Months'])}} <span style="color:#4cb826; font-weight:bold; text-align:right">On Time</span> </em>
</p>

<div class="grid-block">
<table  border="0" align="center">
<tr>
<td width="20px"><p class="red-icon"></p></td><td  width="80px"><p class="sus" style="font-size: 16px; text-align:left" >On Time</p></td>
<td width="20px"><p class="green-icon"></p></td><td  width="80px"><p class="prog" style="font-size: 16px; text-align:left">1-89 days late</p></td>
<td width="20px"><p class="orange-icon"></p></td><td  width="80px"><p class="dang" style="font-size: 16px; text-align:left">90+ days late</p></td></tr>
</table>
</div>
<div class="clear" style="clear:both; width:100%; height:10px; display:block;"></div>
<div class="div">
<table class="table table-bordered " border="1px" align="center" width="96%" style="border:solid 1px #000"  >
<thead>
<tr>
<th scope="col">&nbsp;</th>
<th scope="col">Dec</th>
<th scope="col">Nov</th>
<th scope="col">Oct</th>
<th scope="col">Sep</th>
<th scope="col">Aug</th>
<th scope="col">Jul</th>
<th scope="col">Jun</th>
<th scope="col">May</th>
<th scope="col">Apr</th>
<th scope="col">Mar</th>
<th scope="col">Feb</th>
<th scope="col">Jan</th>
</tr>
</thead>
<tbody>
@foreach($tempYears as $tempYears_key => $tempYears_value)
<tr>
<td>{{$tempYears_key}}</td>
<td>{!! isset($tempYears_value['Dec']) ? $tempYears_value['Dec'] : '' !!}</td>
<td>{!! isset($tempYears_value['Nov']) ? $tempYears_value['Nov'] : '' !!}</td>
<td>{!! isset($tempYears_value['Oct']) ? $tempYears_value['Oct'] : '' !!}</td>
<td>{!! isset($tempYears_value['Sep']) ? $tempYears_value['Sep'] : '' !!}</td>
<td>{!! isset($tempYears_value['Aug']) ? $tempYears_value['Aug'] : '' !!}</td>
<td>{!! isset($tempYears_value['Jul']) ? $tempYears_value['Jul'] : '' !!}</td>
<td>{!! isset($tempYears_value['Jun']) ? $tempYears_value['Jun'] : '' !!}</td>
<td>{!! isset($tempYears_value['May']) ? $tempYears_value['May'] : '' !!}</td>
<td>{!! isset($tempYears_value['Apr']) ? $tempYears_value['Apr'] : '' !!}</td>
<td>{!! isset($tempYears_value['Mar']) ? $tempYears_value['Mar'] : '' !!}</td>
<td>{!! isset($tempYears_value['Feb']) ? $tempYears_value['Feb'] : '' !!}</td>
<td>{!! isset($tempYears_value['Jan']) ? $tempYears_value['Jan'] : '' !!}</td>
</tr>
@endforeach
</tbody>
</table>
</div>
</div>

</div>

<div style="border-bottom: solid 1px #ccc; clear:both; width:100%; height:1px; margin:0 0 0 0; padding:0 0 0 0;"></div>


@endforeach

</div>


    @if(isset($response['CCRResponse']['CIRReportDataLst'][0]['CIRReportData']['Enquiries']) && count($response['CCRResponse']['CIRReportDataLst'][0]['CIRReportData']['Enquiries']) > 0)
    <div style="page-break-after: always"></div>
    <div class="sub_mainBlock" style="margin-top:0">
        <h2 style="margin-top:30px;">Enquires</h2>
        <div class="full_block">
            @if(isset($response['CCRResponse']['CIRReportDataLst'][0]['CIRReportData']['Enquiries']))
            @foreach ($response['CCRResponse']['CIRReportDataLst'][0]['CIRReportData']['Enquiries'] as $key => $value)
            <div class="enquires_section" style="margin-bottom: 0px;     height:200px;">
                <h4 class="sub-head">Enquiry #{{$key+1}}</h4>
                <div class="inner">
                    <div class="item">
                        <div class="left-block">
                        <p style="margin-bottom:10px;"><span style="width: 120px; display:inline-block">Lender name::</span> <span style="color: #202f7d; font-weight: bold;">**** **** {{substr($value['Institution'], 140)}}</span></p>
                            <p><span style="width: 120px; display:inline-block">Date:</span>
                                <span style="color: #202f7d; font-weight: bold;">{{ General::getFormatedDate($value['Date']) }}</span></p>
                           
                        </div>
                        <div class="right-block">
                            <p><span style="width: 120px; display:inline-block">Purpose:</span><span style="color: #202f7d; font-weight: bold;">{{ General::getInquiryPurpose($value['RequestPurpose']) }}</span></p>
                            <p><span style="width: 120px; display:inline-block">Amount:</span> <span style="color: #202f7d; font-weight: bold;">{{ isset($value['Amount ']) ? $value['Amount '] : '-' }}</span></p>
                        </div>
                        <div class="clear" style="clear:both; width:100%; height:1px; display:block;"></div>
                    </div>
                </div>
            </div>

            @endforeach
            @endif
        </div>
    </div>
    @endif
</div>
<div style="page-break-after: always"></div>
@endif

@if(count($records) > 0) 



<div class="pdf_screens recordent-pdf">
    <h1 class="pdf-title eq-title recordent-eq-title">Recordent</h1>
    <div class="pdf_block pdf_progress" style="height:220px; " >
      <div class="inner">
         <div class="rc_top">
            <div class="left_top">
               <h4>Recordent score is:</h4>
            </div>
           
            <div class="clear"></div>
         </div>
         <div class="rc_mid">
            <h2 style="font-size:50px; padding:0px 0 30px 0;">Coming soon !</h2>
         </div>
      
         <p class="last-update">Report Date: {{General::getFormatedDate($dateTime)}}</p>
      </div>
    </div>


    <div class="pdf-row" >

        <div class="pdf_block bottom_block" style="width:575px; height:110px; float:left; border-left: 10px solid #202f7d; ">
         <div class="inner">
         <h4 class="sub">Profile information</h4>  
         <p style="margin-top:50px;"><i style="font-style:normal">Phone: </i><span>{{$user['number']}}</span></p>       
         </div>
        </div>
      
        <div class="pdf_block bottom_block" style="width:575px; height:110px; float:left; margin-left:28px; border-left: 10px solid #202f7d; ">
            <div class="inner">
                <h4 class="sub">Members</h4>    
                <p style="margin-top:50px;">Total Members Reporting Dues: <span>{{$user['recordent']['total_members']}}</span></p>            
            </div>
        </div>

        <div class="clear" style="clear:both; width:100%; height:1px; display:block;"></div>
      
        <div class="pdf_block bottom_block" style="width:575px; height:110px; float:left ; border-left: 10px solid #202f7d; ">
            <div class="inner" >
                <h4 class="sub">Invoices</h4>
                <p>No.of records: {{$user['recordent']['summary_overDueStatus0To89Days']+$user['recordent']['summary_overDueStatus90To179Days']+$user['recordent']['summary_overDueStatus180PlusDays']}}</p>
                <p  style="margin-top:15px;">Overdue status</p>
                <p>
                    <span>1-89 days : {{$user['recordent']['summary_overDueStatus0To89Days']}}</span>  <span>90-180 days : {{$user['recordent']['summary_overDueStatus90To179Days']}}</span>  <span>180+ days : {{$user['recordent']['summary_overDueStatus180PlusDays']}}</span>
                </p>        
            </div>
        </div>

        <div class="pdf_block bottom_block" style="width:575px; height:110px; float:left; margin-left:28px; border-left: 10px solid #202f7d; ">
            <div class="inner">
                <h4 class="sub">Total dues</h4>
                  <p  style="margin:20px 0 10px; 0">Total Due Amount: Rs {{number_format($user['recordent']['total_dues_paid']+$user['recordent']['total_dues_unpaid'])}}</p>
                  <p class="ac_inline" style="display: inline-block; width: 200px; margin-left:5px">Paid: <span>Rs {{$user['recordent']['total_dues_paid']}}</span></p>
                  <p class="ac_inline ac_lm" style="display: inline-block; width: 200px;">Unpaid: <span>Rs {{number_format($user['recordent']['total_dues_unpaid'])}}</span></p>
            </div>
        </div> 
   
        <div class="clear" style="clear:both; width:100%; height:1px; display:block;"></div>
    </div>


    <div class="sub_mainBlock ntb recordent_sub_mainBlock" style="border: none; " >
        <h2>Profile</h2>
        <div class="block">
         
            <ul>
                <li style="font-size:18px; line-height:26px"><span style="font-size:18px; line-height:26px">Consumer's name:</span> <span style="font-size:16px; line-height:24px">{{$user['name']}}  </span></li>
                <li style="font-size:18px; line-height:26px"><span style="font-size:18px; line-height:26px">DOB:</span> <span style="font-size:18px; line-height:26px">
                {{$user['dob']}}
                   </span>
                </li>
            </ul>
           
            <div class="clear" style="clear:both; width:100%; height:1px; display:block;"></div>
        </div>
        <div class="block" style="margin-left:18px;">
       
            <ul>
             <li style="font-size:18px; line-height:26px"><span style="font-size:18px; line-height:26px">UID:</span> <span style="font-size:18px; line-height:26px">
             @if(isset($consentRequest) && isset($consentRequest[0]) && isset($consentRequest[0]['idtype']) && $consentRequest[0]['idtype'] == 'AADHAR')
                                ****** {{substr($user['id_value'], -6)}}
                                @else
                                -
                                @endif
                   </span>
                </li>
                <li style="font-size:18px; line-height:26px"><span style="font-size:18px; line-height:26px">Mobile phone:</span><span style="font-size:18px; line-height:26px">{{$user['number']}}</span> </li>
                
            </ul>
        
            <div class="clear" style="clear:both; width:100%; height:1px; display:block;"></div>
        </div>
      
     
        <div class="clear" style="clear:both; width:100%; height:1px; display:block;"></div>
    </div>


    <div class="clear" style="clear:both; width:100%; height:30px; display:block;"></div>

    <div class="recdodent_block">
        <?php
           $invoice_count = 0;
           ?>
        @forelse($records as $data)
        <div class="sub_mainBlock recd_sub_mainBlock" style="margin-bottom:30px;">
            <h2>Inovice for member:   {{General::getMaskedCharacterAndNumber($data->person_name)}}</h2>
            @foreach($data->dues as $due_k => $due_v)

            <?php
                $invoice_count++;
                $now = time(); // or your date as well
                $your_date = strtotime($due_v->due_date);
                $datediff = $now - $your_date;
                $days = round($datediff / (60 * 60 * 24));

                $temp_paid_amount = 0;
                foreach ($due_v->paid as $temp_r_due_paid_key => $temp_r_due_paid_value) {
                    $temp_paid_amount += $temp_r_due_paid_value->paid_amount;
                } 
            ?>




            <div class="innner01 mb30" > 

                <div id="summary" style="width:100%; border-bottom: solid 1px #eee; padding-bottom:10px; padding-top:10px">
                    <table width="100%">
                        <tr>
                            <td width="50%">
                                <div class="block01" style="height:80px;">         
                                    <ul>
                                        <li><span>Invoice no:</span>  <span>{{$due_v->id}}</span>  <span></li>
                                        <li><span>Status:</span> <span>Unpaid</span></li>
                                        <li><span>Overdue status:</span> <span>{{$days > 0 ? $days. ' days' : '-'}}</span></li>  
                                    </ul>
                                    <div class="clear"></div>
                                </div>
                            </td>
                            <td width="50%">
                                <div class="block01" style="height:80px;">         
                                <ul>
                                <li><span>Due date:</span> <span>{{General::getFormatedDate($due_v->due_date)}}</span></li>
                                <li><span>Date Reported:</span> <span>{{General::getFormatedDate($due_v->created_at)}}</span></li>   
                                <li><span>Last Payment Date:</span> <span>{{count($due_v->paid) > 0 ? General::getFormatedDate($due_v->paid[count($due_v->paid) - 1]->paid_date) : '-'}}</span></li>                 
                                </ul>
                                <div class="clear"></div>
                                </div>
                            </td>
                        </tr>
                        <tr>
                            <td width="50%">
                                <div class="block01" style="height:80px;">         
                                <ul>
                                <li><span>Opening balance:</span> <span>Rs {{number_format($due_v->due_amount)}}</span></li>  
                                <li><span>Closing balance:</span> <span>Rs {{number_format($due_v->due_amount - $temp_paid_amount)}}</span></li>  
                                <li><span>Last payment:</span> <span>Rs {{count($due_v->paid) > 0 ? $due_v->paid[count($due_v->paid) - 1]->paid_amount : '-'}}</span></li> 
                                </ul>
                                <div class="clear"></div>
                                </div>
                            </td>
                            <td width="50%">
                                <div class="block01" style="height:80px;">         
                                    <ul>
                                    @if(!empty($due_v->proof_of_due))
                                    <li><span>Proof of dues:</span><span>Yes</span>  </li>
                                    @else
                                    <li><span>Proof of dues:</span><span>No</span></li>
                                    @endif
                                    <li><span>Dispute:</span> <span> - </span></li>             
                                    </ul>
                                    <div class="clear"></div>
                                </div>
                            </td>
                        </tr>
                    </table>
                </div>
            </div>
  


  


          

            @foreach($due_v->paid as $r_due_paid_key => $r_due_paid_value)

                <?php $invoice_count++; ?>
       
                <div class="innner02 mb30"> 

                    <div id="summary" style="width:100%; border-bottom: solid 1px #eee; padding:10px 0 10px 0">
                    <table width="100%">
                        <tr>
                            <td width="50%">
                            <div class="block01" style="height:100px;">         
                            <ul>
                            <li><span>Invoice no:</span> <span> {{$r_due_paid_value->due_id}}</span></h4>
                            <li><span>Status</span><span> Paid</span></li>
                            <li><span>Paid amount:</span><span>Rs {{$r_due_paid_value->paid_amount}}</span></li>
                            <li><span>Due amount:</span><span>Rs {{$due_v->due_amount}}</span></li>
                            </ul>
                            <div class="clear"></div>
                            </div>
                            </td>
                                <td width="50%">
                                <div class="block01" style="height:100px; ">         
                                <ul>
                                <li><span>Due date:</span><span> {{General::getFormatedDate($due_v->due_date)}}</span></li>
                                <li><span>Paid date:</span><span> {{General::getFormatedDate($r_due_paid_value->paid_date)}}</span></li>  
                                <li><span>Date reported:</span><span> {{General::getFormatedDate($due_v->created_at)}}</span></li>              
                                </ul>
                                <div class="clear"></div>
                                </div>
                            </td>
                        </tr>
                    </table>
                </div>

                <div class="clear" style="clear:both; width:100%; height:1px; display:block;"></div>
            </div>
            
            @endforeach
         @endforeach
      </div>
    @empty
    @endforelse  




  



</div>
   </div>










@endif
</div>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
@if(isset($response) && !empty($response))
<script>
    var score = "{{ $response['CCRResponse']['CIRReportDataLst'][0]['CIRReportData']['ScoreDetails'][0]['Value'] }}";
    var scoreBackgroundvalue = '#ff6c6c !important';

    if (score > 750) {
        scoreBackgroundvalue = '#82e360 !important';
    } else if (score > 700 && score <= 750) {
        scoreBackgroundvalue = 'progress_bar_yellow';
    } else if (score > 650 && score <= 700) {
        scoreBackgroundvalue = 'progress_bar_orange';
    } else if (score <= 650) {
        scoreBackgroundvalue = 'progress_bar_red';
    }
    console.log(scoreBackgroundvalue);
    // $('#progress-bar-active-score').css('background', scoreBackgroundvalue);
    $('#progress-bar-active-score').addClass(scoreBackgroundvalue);
</script>
@endif

